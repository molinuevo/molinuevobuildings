<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html">
        <link rel="canonical" href="https://molinuevo.github.io/molinuevobuildings/_modules/building_stock_energy_model/model.html">

    <!-- Generated with Sphinx 8.1.2 and Furo 2025.09.25 -->
        <title>building_stock_energy_model.model - iDesignRES - Building Stock Energy Model</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #007acc;
  --color-brand-content: #007acc;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">iDesignRES - Building Stock Energy Model</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <span class="sidebar-brand-text">iDesignRES - Building Stock Energy Model</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api_reference.html">API Reference</a><input aria-label="Toggle navigation of API Reference" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modules.html">Modules</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for building_stock_energy_model.model</h1><div class="highlight"><pre>
<span></span><span class="c1"># This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the GNU General Public License as published by</span>
<span class="c1"># the Free Software Foundation; either version 2 of the License, or</span>
<span class="c1"># (at your option) any later version.</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># GNU General Public License for more details.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the GNU General Public License</span>
<span class="c1"># along with this program; if not, write to the Free Software</span>
<span class="c1"># Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2025 Tecnalia Research &amp; Innovation</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pvlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">building_stock_energy_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">calendar</span><span class="w"> </span><span class="kn">import</span> <span class="n">isleap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas.errors</span><span class="w"> </span><span class="kn">import</span> <span class="n">PerformanceWarning</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyproj</span><span class="w"> </span><span class="kn">import</span> <span class="n">Transformer</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">openpyxl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">op</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Alignment</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span> <span class="n">PatternFill</span>


<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">PerformanceWarning</span><span class="p">)</span>


<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 01 : Load the previous result</span>
<div class="viewcode-block" id="s01LoadPreviousResult">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s01LoadPreviousResult">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s01LoadPreviousResult</span><span class="p">(</span><span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 01: Load the previous result.</span>

<span class="sd">    Args:</span>
<span class="sd">        nutsId (str): Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#  Create the temporary directory</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 01/&gt;  Creating the temporary directory...&#39;</span><span class="p">)</span>
    <span class="n">temporaryDirectory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;temporary&#39;</span>
    <span class="n">temporaryDirectory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">#  Load the result file of the Buildings preprocess</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 01/&gt;  Loading the result file of the Buildings preprocess...&#39;</span><span class="p">)</span>
    <span class="n">csvPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;usecases&#39;</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nutsId</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">_preprocess.csv&#39;</span>
    <span class="n">dfPreprocess</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csvPath</span><span class="p">,</span>
                               <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                               <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

    <span class="c1">#  Load the solar data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 01/&gt;  Loading the solar data...&#39;</span><span class="p">)</span>
    <span class="n">csvPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;usecases&#39;</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nutsId</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">_solar.csv&#39;</span>
    <span class="n">dfSolar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csvPath</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                          <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                          <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 01/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfPreprocess</span><span class="p">,</span> <span class="n">dfSolar</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 02 -&gt; Retrieve temperatures</span>
<div class="viewcode-block" id="s02RetrieveTemperatures">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s02RetrieveTemperatures">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s02RetrieveTemperatures</span><span class="p">(</span><span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                            <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 02: Retrieve temperatures.</span>

<span class="sd">    Args:</span>
<span class="sd">        nutsId (str): Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">        year (int): The selected year.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the CSV from the database</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 02/&gt;  Retrieving temperatures...&#39;</span><span class="p">)</span>
    <span class="n">csvPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> \
        <span class="s1">&#39;07-DemandNinja_Temperature_DB.csv&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csvPath</span><span class="p">,</span>
                     <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># Filter for the row that contains the country code</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CNTR_CODE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Model: Step 02/&gt;  &#39;</span> <span class="o">+</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; not mapped!&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 02/&gt;  Connecting and downloading...&#39;</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;PopWgt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;Model: Step 02/&gt;  The temepratures data could not be downloaded!&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 02/&gt;  Loading and filtering the downloaded data...&#39;</span><span class="p">)</span>
    <span class="n">downloadedData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span>
        <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">),</span>
        <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
        <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

    <span class="c1"># Normalize to UTC native</span>
    <span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                                            <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Choose region column</span>
    <span class="n">regionCode</span> <span class="o">=</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">regionCode</span> <span class="ow">in</span> <span class="n">downloadedData</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">selectedRegion</span> <span class="o">=</span> <span class="n">regionCode</span>
    <span class="k">elif</span> <span class="n">regionCode</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="n">downloadedData</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">selectedRegion</span> <span class="o">=</span> <span class="n">regionCode</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selectedRegion</span> <span class="o">=</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Determine the range of years available for the downloaded CSV file.</span>
    <span class="n">yearsAvailable</span> <span class="o">=</span> <span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># Source year to use for calculating the target year</span>
    <span class="n">srcYear</span> <span class="o">=</span> <span class="n">year</span> <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span>
        <span class="n">yearsAvailable</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">yearsAvailable</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="c1"># Filter hourly data from the source year</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">downloadedData</span><span class="p">[</span><span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span>
                         <span class="n">srcYear</span><span class="p">][[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">selectedRegion</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Remove 29-Feb from the source if it exists.</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">x03DropFeb29IfPresentForTemperaturesData</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>

    <span class="c1"># Ensure numeric data type and clean up NaN values.</span>
    <span class="n">src</span><span class="p">[</span><span class="n">selectedRegion</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="n">selectedRegion</span><span class="p">],</span>
                                        <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">selectedRegion</span><span class="p">])</span>

    <span class="c1"># If the destination year is the same as the origin year, there is no remapping</span>
    <span class="c1"># If it is different, the dates are relabeled.</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="n">srcYear</span><span class="p">:</span>
        <span class="c1"># Remap</span>
        <span class="n">new_index</span> <span class="o">=</span> <span class="n">x05RemapYear</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                 <span class="n">year</span><span class="p">)</span>
        <span class="n">src</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new_index</span>
        <span class="k">if</span> <span class="n">isleap</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
            <span class="n">src</span> <span class="o">=</span> <span class="n">x01AddFeb29IfMissingForTemperaturesData</span><span class="p">(</span><span class="n">src</span><span class="p">,</span>
                                                          <span class="n">year</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If the target year is not a leap year, ensure that February 29th</span>
        <span class="c1"># does not exist (it was already removed above)</span>
        <span class="c1"># If it is a leap year and February 29th is missing,</span>
        <span class="c1"># it&#39;s possible to add it (optional)</span>
        <span class="k">pass</span>

    <span class="c1"># Consistent time series data for the year &quot;year&quot; in the selected region column</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">selectedRegion</span><span class="p">:</span> <span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Daily calculations</span>
    <span class="n">dailyMin</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span><span class="p">])[</span>
        <span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">dailyMax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span><span class="p">])[</span>
        <span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">dailyAvgTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">dailyMin</span> <span class="o">+</span> <span class="n">dailyMax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dailyAvgTemp</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-01-01&#39;</span><span class="p">,</span>
                                       <span class="n">end</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">-01-01&#39;</span><span class="p">,</span>
                                       <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span>
                                       <span class="n">inclusive</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">dailyAvgTemp</span> <span class="o">=</span> <span class="n">dailyAvgTemp</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>

    <span class="c1"># Mensual: (min+max)/2 por mes -&gt; rellenado a horario</span>
    <span class="n">monthlyMin</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">monthlyMax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">monthlyAvgTemp</span> <span class="o">=</span> <span class="p">(</span><span class="n">monthlyMin</span> <span class="o">+</span> <span class="n">monthlyMax</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">allDaysInYear</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-01-01&#39;</span><span class="p">,</span>
                                  <span class="n">end</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">-01-01&#39;</span><span class="p">,</span>
                                  <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span>
                                  <span class="n">inclusive</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">monthlyAvgTemp</span> <span class="o">=</span> <span class="n">monthlyAvgTemp</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">allDaysInYear</span><span class="p">,</span>
                                            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>

    <span class="c1"># Add columns</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;DailyAvgTemp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dailyAvgTemp</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;MonthlyAvgTemp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">monthlyAvgTemp</span>

    <span class="c1"># Fill this out in case there are any hours missing after 12/31</span>
    <span class="n">lastDayFirstHour</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">-12-31 00:00:00&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lastDayFirstHour</span> <span class="ow">in</span> <span class="n">dailyAvgTemp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">firstHourValueDailyAvg</span> <span class="o">=</span> <span class="n">dailyAvgTemp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lastDayFirstHour</span><span class="p">]</span>
        <span class="n">firstHourValueMonthlyAvg</span> <span class="o">=</span> <span class="n">monthlyAvgTemp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lastDayFirstHour</span><span class="p">]</span>
        <span class="n">maskDaily</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">lastDayFirstHour</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;DailyAvgTemp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
        <span class="n">maskMonthly</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">lastDayFirstHour</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MonthlyAvgTemp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">maskDaily</span><span class="p">,</span> <span class="s1">&#39;DailyAvgTemp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstHourValueDailyAvg</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">maskMonthly</span><span class="p">,</span> <span class="s1">&#39;MonthlyAvgTemp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">firstHourValueMonthlyAvg</span>

    <span class="c1"># Seasonal classification</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">season</span><span class="p">(</span><span class="n">temp</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;W&#39;</span> <span class="k">if</span> <span class="n">temp</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">WINTER_TEMPERATURE</span> <span class="k">else</span> <span class="s1">&#39;S&#39;</span> <span class="k">if</span> <span class="n">temp</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">SUMMER_TEMPERATURE</span> <span class="k">else</span> <span class="s1">&#39;M&#39;</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MonthlyAvgTemp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>

    <span class="c1"># Save to the temporary directory</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 02/&gt;  Saving as CSV to a temporary directory...&#39;</span><span class="p">)</span>
    <span class="n">csvPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;temporary&#39;</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">_Temperatures.csv&#39;</span>
    <span class="n">dfOut</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">dfOut</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">dfOut</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y %H:%M&#39;</span><span class="p">)</span>
    <span class="n">dfOut</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvPath</span><span class="p">,</span>
                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                 <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 02/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfOut</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 03 -&gt; Retrieve radiation values</span>
<div class="viewcode-block" id="s03RetrieveRadiationValues">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s03RetrieveRadiationValues">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s03RetrieveRadiationValues</span><span class="p">(</span><span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                               <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 03: Retrieve radiation values.</span>

<span class="sd">    Args:</span>
<span class="sd">        nutsId (str): Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">        year (int): The selected year.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the CSV from the database</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 03/&gt;  Retrieving the radiation values...&#39;</span><span class="p">)</span>
    <span class="n">csvPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> \
        <span class="s1">&#39;06-DemandNinja_Radiation_DB.csv&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csvPath</span><span class="p">,</span>
                     <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>

    <span class="c1"># Filter for the row that contains the country code</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CNTR_CODE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Model: Step 03/&gt; &#39;</span> <span class="o">+</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; not mapped!&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 03/&gt;  Connecting and downloading...&#39;</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;PopWgt&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s1">&#39;Model: Step 03/&gt;  The radiation data could not be downloaded!&#39;</span><span class="p">)</span>

    <span class="c1"># Normalize the time column</span>
    <span class="n">downloadedData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span>
        <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">),</span>
        <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span>
        <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
        <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
        <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
    <span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span> <span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                                            <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Region column selection</span>
    <span class="n">regionCode</span> <span class="o">=</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">regionCode</span> <span class="ow">in</span> <span class="n">downloadedData</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">selectedRegion</span> <span class="o">=</span> <span class="n">regionCode</span>
    <span class="k">elif</span> <span class="n">regionCode</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="n">downloadedData</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">selectedRegion</span> <span class="o">=</span> <span class="n">regionCode</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selectedRegion</span> <span class="o">=</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Detect available years range and establish the source year</span>
    <span class="n">availableYears</span> <span class="o">=</span> <span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">srcYear</span> <span class="o">=</span> <span class="n">year</span> <span class="k">if</span> <span class="n">year</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span>
        <span class="n">availableYears</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">availableYears</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

    <span class="c1"># Filter by source year</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">downloadedData</span><span class="p">[</span><span class="n">downloadedData</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span>
                         <span class="n">srcYear</span><span class="p">][[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">selectedRegion</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

    <span class="c1"># Clean</span>
    <span class="n">src</span><span class="p">[</span><span class="n">selectedRegion</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="n">selectedRegion</span><span class="p">],</span>
                                        <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">selectedRegion</span><span class="p">])</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">x04DropFeb29IfPresentForRadiationData</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>

    <span class="c1"># Remap if the year is different than the source year</span>
    <span class="k">if</span> <span class="n">year</span> <span class="o">!=</span> <span class="n">srcYear</span><span class="p">:</span>
        <span class="n">src</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">x05RemapYear</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                                 <span class="n">year</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isleap</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
            <span class="n">src</span> <span class="o">=</span> <span class="n">x02AddFeb29IfMissingForRadiationData</span><span class="p">(</span><span class="n">src</span><span class="p">,</span>
                                                       <span class="n">year</span><span class="p">)</span>

    <span class="c1"># Rename the column to the original nuts code</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">selectedRegion</span><span class="p">:</span> <span class="n">nutsId</span><span class="p">})</span>

    <span class="c1"># Date format to export</span>
    <span class="n">src</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y %H:%M&#39;</span><span class="p">)</span>

    <span class="c1"># Save to the temporary directory</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 03/&gt;  Saving as CSV to the temporary directory...&#39;</span><span class="p">)</span>
    <span class="n">csvPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;temporary&#39;</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">selectedRegion</span><span class="si">}</span><span class="s1">_Radiation.csv&#39;</span>
    <span class="n">src</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvPath</span><span class="p">,</span>
               <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
               <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 03/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 04 -&gt; Load the database</span>
<div class="viewcode-block" id="s04LoadDatabase">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s04LoadDatabase">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s04LoadDatabase</span><span class="p">(</span><span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                    <span class="n">hddReduction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                    <span class="n">cddReduction</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 04: Load the database.</span>

<span class="sd">    Args:</span>
<span class="sd">        nutsId (str): Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">        hddReduction (float): Reduction in heating degree days</span>
<span class="sd">            for future scenario.</span>
<span class="sd">        cddReduction (float): Reduction in cooling degree days</span>
<span class="sd">            for future scenarios.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 04/&gt;  Loading the database...&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;08-DHW&amp;InternalGains.csv&#39;</span>
    <span class="n">dfDHW</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                        <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                        <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                        <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;23-YearPeriods.csv&#39;</span>
    <span class="n">dfYears</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                          <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;24-Sectors.csv&#39;</span>
    <span class="n">dfSectors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                            <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;26-Season.csv&#39;</span>
    <span class="n">dfSeasons</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                            <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                            <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;temporary&#39;</span> <span class="o">/</span> \
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s1">_Temperatures.csv&#39;</span>
    <span class="n">dfTemperatures</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                 <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                 <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;18-Schedule.csv&#39;</span>
    <span class="n">dfSchedule</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                             <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                             <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                             <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;15-RES_hh_tes.xlsx&#39;</span>
    <span class="n">dfResHHTes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;19-SER_hh_tes.xlsx&#39;</span>
    <span class="n">dfSerHHTes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;22-UValues.csv&#39;</span>
    <span class="n">dfUvalues</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                            <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                            <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                            <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> \
        <span class="s1">&#39;17-RetrofittingUValues.csv&#39;</span>
    <span class="n">dfRetroUvalues</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                 <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                 <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;01-ACH.csv&#39;</span>
    <span class="n">dfACH</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                        <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                        <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                        <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;02-BaseTemperatures.csv&#39;</span>
    <span class="n">dfBaseTemperatures</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                                     <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                     <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                     <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;27-Calendar.csv&#39;</span>
    <span class="n">dfCalendar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                             <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                             <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                             <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;04-BES_CAPEX.csv&#39;</span>
    <span class="n">dfBesCapex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                             <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                             <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                             <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                             <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;05-BES_OPEX.csv&#39;</span>
    <span class="n">dfBesOpex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                            <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                            <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                            <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                            <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;14-RES.csv&#39;</span>
    <span class="n">dfRes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                        <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                        <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                        <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                        <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;03-BES_Capacity.csv&#39;</span>
    <span class="n">dfBesCapacity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                                <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                                <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;16-RetrofittingCost.csv&#39;</span>
    <span class="n">dfRetroCost</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                              <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                              <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                              <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                              <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> \
        <span class="s1">&#39;21-SolarGainsOffice(Wm2).csv&#39;</span>
    <span class="n">dfSolarOffice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                                <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> \
        <span class="s1">&#39;20-SolarGainsNONOffice(Wm2).csv&#39;</span>
    <span class="n">dfSolarNoffice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                 <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                                 <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                                 <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> \
        <span class="s1">&#39;09-DwellingSizeAndShare.csv&#39;</span>
    <span class="n">dfDwellings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                              <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                              <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                              <span class="n">thousands</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                              <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;13-R_T_hh_eff.xlsx&#39;</span>
    <span class="n">dfRTHHEff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;database&#39;</span> <span class="o">/</span> <span class="s1">&#39;28-Solar_parameter_buildings.json&#39;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">jsonFile</span><span class="p">:</span>
        <span class="n">dictBuildings</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">jsonFile</span><span class="p">)</span>

    <span class="c1"># Build the HDH dataframe</span>
    <span class="n">dfHDH</span> <span class="o">=</span> <span class="n">dfCalendar</span><span class="p">[[</span><span class="s1">&#39;Datetime&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">dfHDH</span><span class="p">[</span><span class="s1">&#39;HDH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dfHDH</span><span class="p">[</span><span class="s1">&#39;CDH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfTemperatures</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Base Temperature&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ThresholdTemperture&#39;</span><span class="p">]):</span>
            <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Base Temperature&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Base Temperature&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ThresholdTemperture&#39;</span><span class="p">]):</span>
            <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> \
                <span class="nb">float</span><span class="p">(</span><span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Base Temperature&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">dfHDH</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;HDH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hddReduction</span><span class="p">)</span>
        <span class="n">dfHDH</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;CDH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cddReduction</span><span class="p">)</span>

    <span class="c1"># Append the HDH dataframe to the Schedule dataframe</span>
    <span class="n">dfHDHExtended</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">ln</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dfSchedule</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Use&#39;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span>
        <span class="n">dfHDHExtended</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfHDHExtended</span><span class="p">,</span> <span class="n">dfHDH</span><span class="p">],</span>
                                  <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfSchedule</span><span class="p">[[</span><span class="s1">&#39;HDH&#39;</span><span class="p">,</span> <span class="s1">&#39;CDH&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dfHDHExtended</span><span class="p">[[</span><span class="s1">&#39;HDH&#39;</span><span class="p">,</span> <span class="s1">&#39;CDH&#39;</span><span class="p">]]</span>

    <span class="c1"># Add to the Temperatures dataframe the Heating and Cooling factors</span>
    <span class="n">dfTemperatures</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfSeasons</span><span class="p">[[</span><span class="s1">&#39;Season&#39;</span><span class="p">,</span> <span class="s1">&#39;Heating&#39;</span><span class="p">]],</span>
                                          <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Season&#39;</span><span class="p">,</span>
                                          <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">dfTemperatures</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dfSeasons</span><span class="p">[[</span><span class="s1">&#39;Season&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooling&#39;</span><span class="p">]],</span>
                                          <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Season&#39;</span><span class="p">,</span>
                                          <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 04/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfDHW</span><span class="p">,</span> <span class="n">dfYears</span><span class="p">,</span> <span class="n">dfSectors</span><span class="p">,</span> <span class="n">dfSeasons</span><span class="p">,</span> <span class="n">dfTemperatures</span><span class="p">,</span> <span class="n">dfSchedule</span><span class="p">,</span> <span class="n">dfResHHTes</span><span class="p">,</span> \
        <span class="n">dfSerHHTes</span><span class="p">,</span> <span class="n">dfUvalues</span><span class="p">,</span> <span class="n">dfRetroUvalues</span><span class="p">,</span> <span class="n">dfACH</span><span class="p">,</span> <span class="n">dfBaseTemperatures</span><span class="p">,</span> <span class="n">dfCalendar</span><span class="p">,</span> \
        <span class="n">dfBesCapex</span><span class="p">,</span> <span class="n">dfBesOpex</span><span class="p">,</span> <span class="n">dfRes</span><span class="p">,</span> <span class="n">dfBesCapacity</span><span class="p">,</span> <span class="n">dfRetroCost</span><span class="p">,</span> <span class="n">dfSolarOffice</span><span class="p">,</span> \
        <span class="n">dfSolarNoffice</span><span class="p">,</span> <span class="n">dfDwellings</span><span class="p">,</span> <span class="n">dfRTHHEff</span><span class="p">,</span> <span class="n">dictBuildings</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 05 -&gt; Retrieve solar data</span>
<div class="viewcode-block" id="s05RetrieveSolarData">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s05RetrieveSolarData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s05RetrieveSolarData</span><span class="p">(</span><span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                         <span class="n">listInputJsonSolar</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                         <span class="n">dictDBBuildings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 05: Retrieve radiation values.</span>

<span class="sd">    Args:</span>
<span class="sd">        nutsId (str): Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">        year (int): The selected year.</span>
<span class="sd">        listInputJsonSolar(list): Data from the input.json file. Example::</span>

<span class="sd">            [</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Apartment Block&#39;, &#39;area_total&#39;: None, &#39;power&#39;: 195.826, &#39;capex&#39;: None},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Single family- Terraced houses&#39;, ...},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Offices&#39;, ...},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Education&#39;, ...},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Health&#39;, ...},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Trade&#39;, ...},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Hotels and Restaurants&#39;, ...},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Other non-residential buildings&#39;, ...},</span>
<span class="sd">                {&#39;building_use&#39;: &#39;Sport&#39;, ...}</span>
<span class="sd">            ]</span>
<span class="sd">        </span>
<span class="sd">        dictDBBuildings (dict): Data from the database file. Example::</span>

<span class="sd">            {</span>
<span class="sd">                &#39;System&#39;: {&#39;system_cost&#39;: 0.5, &#39;opex_pv&#39;: 15000, &#39;min_ghi_pv&#39;: 1000, &#39;land_use_pv&#39;: 100},</span>
<span class="sd">                &#39;Apartment Block&#39;: {&#39;tilt&#39;: 30, &#39;azimuth&#39;: 180, &#39;loss&#39;: 14, &#39;efficiency&#39;: 18,</span>
<span class="sd">                    &#39;tracking_porcentage&#39;: 0, &#39;use_factor&#39;: 100, &#39;distribution&#39;: [0.6, 0.2, 0.2]},</span>
<span class="sd">                &#39;Single family- Terraced houses&#39;: {...},</span>
<span class="sd">                &#39;Hotels and Restaurants&#39;: {...},</span>
<span class="sd">                &#39;Health&#39;: {...},</span>
<span class="sd">                &#39;Education&#39;: {...},</span>
<span class="sd">                &#39;Offices&#39;: {...},</span>
<span class="sd">                &#39;Sport&#39;: {.},</span>
<span class="sd">                &#39;Trade&#39;: {.},</span>
<span class="sd">                &#39;Other non-residential buildings&#39;: {...},</span>
<span class="sd">            }</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># Load the necessary information</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 05/&gt;  Loading the solar data...&#39;</span><span class="p">)</span>
    <span class="n">filePath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;usecases&#39;</span> <span class="o">/</span> \
        <span class="p">(</span><span class="n">nutsId</span> <span class="o">+</span> <span class="s1">&#39;_solar.csv&#39;</span><span class="p">)</span>
    <span class="n">dfSolar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span>
                          <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span>
                          <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                          <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
    
    <span class="c1"># Obtain the &quot;System&quot; configuration, and read the properties</span>
    <span class="n">dictSystem</span> <span class="o">=</span> <span class="n">dictDBBuildings</span><span class="p">[</span><span class="s1">&#39;System&#39;</span><span class="p">]</span>
    <span class="n">systemCost</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictSystem</span><span class="p">,</span>
                                   <span class="s1">&#39;system_cost&#39;</span><span class="p">,</span>
                                   <span class="mf">0.2</span><span class="p">,</span>
                                   <span class="mi">1</span><span class="p">,</span>
                                   <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">opexPV</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictSystem</span><span class="p">,</span>
                               <span class="s1">&#39;opex_pv&#39;</span><span class="p">,</span>
                               <span class="mi">0</span><span class="p">,</span>
                               <span class="mf">3.0e+04</span><span class="p">,</span>
                               <span class="mf">1.5e+03</span><span class="p">)</span>
    <span class="n">minGHIPV</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictSystem</span><span class="p">,</span>
                                 <span class="s1">&#39;min_ghi_pv&#39;</span><span class="p">,</span>
                                 <span class="mi">500</span><span class="p">,</span>
                                 <span class="mf">2.0e+03</span><span class="p">,</span>
                                 <span class="mf">1.0e+03</span><span class="p">)</span>
    <span class="n">landUsePV</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictSystem</span><span class="p">,</span>
                                  <span class="s1">&#39;land_use_pv&#39;</span><span class="p">,</span>
                                  <span class="mi">50</span><span class="p">,</span>
                                  <span class="mi">200</span><span class="p">,</span>
                                  <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Create dataframes for later, and the output dictionary</span>
    <span class="n">prodAgreggated</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">nuts2Distrib</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Separate by archetypes</span>
    <span class="k">for</span> <span class="n">archetype</span> <span class="ow">in</span> <span class="n">constants</span><span class="o">.</span><span class="n">BUILDING_USES</span><span class="p">:</span>
        <span class="n">dfSolarArch</span> <span class="o">=</span> <span class="n">dfSolar</span><span class="p">[</span><span class="n">dfSolar</span><span class="p">[</span><span class="s1">&#39;Building_Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">archetype</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">listInputJsonSolar</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">archetype</span><span class="p">:</span>
                <span class="c1"># Merge with de information loaded from the database</span>
                <span class="n">dictArchetype</span> <span class="o">=</span> <span class="n">element</span>
                <span class="n">dictArchetype</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dictDBBuildings</span><span class="p">[</span><span class="n">archetype</span><span class="p">])</span>
                <span class="k">break</span>
        
        <span class="n">dictScada</span> <span class="o">=</span> <span class="n">dfSolarArch</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Median_Radiation&#39;</span><span class="p">,</span>
                                            <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        
        <span class="n">areaAvailable</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictArchetype</span><span class="p">,</span>
                                          <span class="s1">&#39;area_total&#39;</span><span class="p">,</span>
                                          <span class="mi">0</span><span class="p">,</span>
                                          <span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span>
                                          <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;area_total&#39;</span> <span class="ow">in</span> <span class="n">dictArchetype</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictArchetype</span><span class="p">,</span>
                                  <span class="s1">&#39;power&#39;</span><span class="p">,</span>
                                  <span class="mi">0</span><span class="p">,</span>
                                  <span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;power&#39;</span> <span class="ow">in</span> <span class="n">dictArchetype</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">capex</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictArchetype</span><span class="p">,</span>
                                  <span class="s1">&#39;capex&#39;</span><span class="p">,</span>
                                  <span class="mi">0</span><span class="p">,</span>
                                  <span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="s1">&#39;capex&#39;</span> <span class="ow">in</span> <span class="n">dictArchetype</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">areaAvailable</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">power</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">capex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">areaAvailable</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">power</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">capex</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="n">loss</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictArchetype</span><span class="p">,</span>
                                 <span class="s1">&#39;loss&#39;</span><span class="p">,</span>
                                 <span class="mi">0</span><span class="p">,</span>
                                 <span class="mi">20</span><span class="p">,</span>
                                 <span class="mi">14</span><span class="p">)</span>
        <span class="n">tracking</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictArchetype</span><span class="p">,</span>
                                     <span class="s1">&#39;tracking_porcentage&#39;</span><span class="p">,</span>
                                     <span class="mi">0</span><span class="p">,</span>
                                     <span class="mi">2</span><span class="p">,</span>
                                     <span class="mi">0</span><span class="p">)</span>
        <span class="n">tilt</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictArchetype</span><span class="p">,</span>
                                 <span class="s1">&#39;tilt&#39;</span><span class="p">,</span>
                                 <span class="mi">0</span><span class="p">,</span>
                                 <span class="mi">90</span><span class="p">,</span>
                                 <span class="mi">30</span><span class="p">)</span>
        <span class="n">azimuth</span> <span class="o">=</span> <span class="n">x06EstablishValue</span><span class="p">(</span><span class="n">dictArchetype</span><span class="p">,</span>
                                    <span class="s1">&#39;azimuth&#39;</span><span class="p">,</span>
                                    <span class="mi">0</span><span class="p">,</span>
                                    <span class="mi">180</span><span class="p">,</span>
                                    <span class="mi">180</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;distribution&#39;</span> <span class="ow">in</span> <span class="n">dictArchetype</span><span class="p">:</span>
            <span class="n">distributionResidential</span> <span class="o">=</span> <span class="n">dictArchetype</span><span class="p">[</span><span class="s1">&#39;distribution&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">distributionResidential</span><span class="p">:</span>
                <span class="n">distribAzimuth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">270</span><span class="p">]</span>
                <span class="n">porcent</span> <span class="o">=</span> <span class="n">distributionResidential</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">porcent</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">distribAzimuth</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">sum</span><span class="p">(</span><span class="n">porcent</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">porcent</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">distribAzimuth</span> <span class="o">=</span> <span class="p">[</span><span class="n">azimuth</span><span class="p">]</span>
                <span class="n">porcent</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">distribAzimuth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">270</span><span class="p">]</span>
            <span class="n">porcent</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>

        <span class="c1"># Obtain the available area</span>
        <span class="n">listParameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">areaAvailable</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">capex</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 05/&gt;  Obtaining the available area for &quot;&#39;</span> <span class="o">+</span> <span class="n">archetype</span> <span class="o">+</span> <span class="s1">&#39;&quot;...&#39;</span><span class="p">)</span>
        <span class="n">areaAvailable</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">capex</span> <span class="o">=</span> <span class="n">x07GetAvailableArea</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">listParameters</span><span class="p">,</span>
                                                          <span class="n">cost</span><span class="o">=</span><span class="n">systemCost</span><span class="p">,</span>
                                                          <span class="n">landUse</span><span class="o">=</span><span class="n">landUsePV</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">areaAvailable</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Obtain the regions</span>
            <span class="n">rows</span><span class="p">,</span> <span class="n">name_nuts2</span> <span class="o">=</span> <span class="n">x08GetRegions</span><span class="p">(</span><span class="n">dictScada</span><span class="o">=</span><span class="n">dictScada</span><span class="p">,</span>
                                             <span class="n">area</span><span class="o">=</span><span class="n">areaAvailable</span><span class="p">,</span>
                                             <span class="n">minGhi</span><span class="o">=</span><span class="n">minGHIPV</span><span class="p">)</span>

            <span class="c1"># Obtain the PV production</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 05/&gt;  Obtaining the PV production for &quot;&#39;</span> <span class="o">+</span> <span class="n">archetype</span> <span class="o">+</span> <span class="s1">&#39;&quot;...&#39;</span><span class="p">)</span>
            <span class="n">productionTracking</span> <span class="o">=</span> <span class="n">x09GetPVProduction</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                                                    <span class="n">landUse</span><span class="o">=</span><span class="n">landUsePV</span><span class="p">,</span>
                                                    <span class="n">tilt</span><span class="o">=</span><span class="n">tilt</span><span class="p">,</span>
                                                    <span class="n">distribAzimuth</span><span class="o">=</span><span class="n">distribAzimuth</span><span class="p">,</span>
                                                    <span class="n">tracking</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                    <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span>
                                                    <span class="n">porcent</span><span class="o">=</span><span class="n">porcent</span><span class="p">,</span>
                                                    <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">)</span>
            <span class="n">productionFixed</span> <span class="o">=</span> <span class="n">x09GetPVProduction</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                                                 <span class="n">landUse</span><span class="o">=</span><span class="n">landUsePV</span><span class="p">,</span>
                                                 <span class="n">tilt</span><span class="o">=</span><span class="n">tilt</span><span class="p">,</span>
                                                 <span class="n">distribAzimuth</span><span class="o">=</span><span class="n">distribAzimuth</span><span class="p">,</span>
                                                 <span class="n">tracking</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                                 <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span>
                                                 <span class="n">porcent</span><span class="o">=</span><span class="n">porcent</span><span class="p">,</span>
                                                 <span class="n">year</span><span class="o">=</span><span class="n">year</span><span class="p">)</span>
            <span class="n">production</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">map</span><span class="p">(</span><span class="nb">sum</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">tracking</span><span class="p">,</span> <span class="n">productionTracking</span><span class="p">),</span>
                             <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">tracking</span><span class="p">),</span> <span class="n">productionFixed</span><span class="p">))))</span>
            <span class="n">prodAgreggated</span><span class="p">[</span><span class="n">archetype</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">production</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">nuts2</span><span class="p">,</span> <span class="n">potDistrib</span><span class="p">,</span> <span class="n">areasDistrib</span> <span class="o">=</span> <span class="n">x10GetDistribution</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                                                                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;production&#39;</span><span class="p">)</span>

    <span class="c1"># Save results in temporary directory</span>
    <span class="n">prodAgreggated</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">prodAgreggated</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M&#39;</span><span class="p">)</span>
    <span class="n">csvPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> \
        <span class="s1">&#39;temporary&#39;</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">nutsId</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">_solar_results.csv&#39;</span>
    <span class="n">prodAgreggated</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvPath</span><span class="p">,</span>
                          <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span>
                          <span class="n">decimal</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 05/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prodAgreggated</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 06 -&gt; Add columns to the main DataFrame</span>
<div class="viewcode-block" id="s06AddColumnsToMainDataFrame">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s06AddColumnsToMainDataFrame">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s06AddColumnsToMainDataFrame</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 06: Add columns to the main dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 06/&gt;  Adding new columns to the input dataframe...&#39;</span><span class="p">)</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfCSV</span><span class="p">,</span>
                       <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Window Area&#39;</span><span class="p">,</span> <span class="s1">&#39;Period&#39;</span><span class="p">,</span> <span class="s1">&#39;Net heated floor area&#39;</span><span class="p">,</span> <span class="s1">&#39;Heated Volume&#39;</span><span class="p">,</span> <span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;Sector&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Ref Level&#39;</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">,</span> <span class="s1">&#39;Solar thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Roof [W/m2K]&#39;</span><span class="p">,</span> <span class="s1">&#39;Wall [W/m2K]&#39;</span><span class="p">,</span> <span class="s1">&#39;Window [W/m2K]&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Equipment internal gains [W/m2]&#39;</span><span class="p">,</span> <span class="s1">&#39;Occupancy internal gains [W/m2]&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting power [W/m2]&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;DHW demand [KW/m2·year]&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking [KW/m2·year]&#39;</span><span class="p">,</span> <span class="s1">&#39;Air renovation losses&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Space heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Conventional electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electricity in circulation&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Conventional electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electricity in circulation&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Water heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Conventional electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electricity in circulation&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Cooking&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;C. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;C. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Conventional electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;C. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;C. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electricity in circulation&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;C. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Lighting&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;L. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;L. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Conventional electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;L. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;L. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electricity in circulation&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;L. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Appliances&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;A. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;A. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Conventional electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;A. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;A. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electricity in circulation&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;A. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Space heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Gas heat pumps base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Natural gas base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Distributed heat base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Advanced electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. BioGas base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solar base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electric space cooling base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Electricity base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Gas heat pumps base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Natural gas base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Distributed heat base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Advanced electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. BioGas base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solar base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electric space cooling base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Electricity base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Water heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Gas heat pumps base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Natural gas base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Distributed heat base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Advanced electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. BioGas base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solar base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electric space cooling base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Electricity base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Cooking base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Gas heat pumps base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Natural gas base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;C. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Distributed heat base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Advanced electric heating base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;C. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. BioGas base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solar base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;C. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electric space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electricity base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Lighting base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Gas heat pumps base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Natural gas base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;L. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Distributed heat base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Advanced electric heating base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;L. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. BioGas base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solar base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;L. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electric space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electricity base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Appliances base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Gas heat pumps base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Natural gas base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;A. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Distributed heat base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Advanced electric heating base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;A. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. BioGas base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solar base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;A. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electric space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electricity base&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SH. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;SC. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;WH. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. SH&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. SH. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. SH. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. EIC&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. SC&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SC. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. SC. Electric space cooling&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. WH&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. WH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. WH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. C&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. C. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. L&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. L. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Eff. A&#39;</span><span class="p">,</span> <span class="s1">&#39;Eff. A. Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SH. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SH. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Hydrogen&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SH. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SH. Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SC. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SC. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SC. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Hydrogen&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX SC. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX SC. Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX WH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX WH. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX WH. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Hydrogen&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX WH. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX WH. Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX C. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX C. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX C. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Hydrogen&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX C. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX C. Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX L. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX L. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX L. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Hydrogen&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX L. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX L. Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX A. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Natural gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX A. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Advanced electric heating&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX A. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Hydrogen&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;CAPEX A. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX A. Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Fixed cost Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Liquids|Oil&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Gases|Gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Fixed cost Solids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Heat&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Liquids|Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Fixed cost Gases|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Fixed cost Heat|Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Variable cost Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Variable cost Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Variable cost Liquids|Oil&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Variable cost Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Variable cost Solids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Variable cost Electricity&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Variable cost Heat&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Variable cost Liquids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Variable cost Gases|Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Variable cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Variable cost Heat|Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Emissions Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Liquids|Oil&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Gases|Gas&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Emissions Solids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Heat&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Liquids|Biomass&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;OPEX Emissions Gases|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;OPEX Emissions Heat|Solar&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;RFC Cost Low Wall&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Wall&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Wall&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;RFC Cost Low Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Roof&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;RFC Cost Low Window&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Window&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Window&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;RES ST. Cost&#39;</span><span class="p">,</span> <span class="s1">&#39;RES ST. Impact&#39;</span><span class="p">,</span> <span class="s1">&#39;RES ST. Lifetime&#39;</span><span class="p">,</span> <span class="s1">&#39;RES ST. Efficiency&#39;</span><span class="p">,</span> <span class="s1">&#39;RES ST. N0&#39;</span><span class="p">,</span> <span class="s1">&#39;RES ST. K1&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;RES ST. K2&#39;</span><span class="p">,</span> <span class="s1">&#39;RES ST. NS&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;RES SP. Cost&#39;</span><span class="p">,</span> <span class="s1">&#39;RES SP. Impact&#39;</span><span class="p">,</span> <span class="s1">&#39;RES SP. Lifetime&#39;</span><span class="p">,</span> <span class="s1">&#39;RES SP. Efficiency&#39;</span><span class="p">,</span> <span class="s1">&#39;RES SP. N0&#39;</span><span class="p">,</span> <span class="s1">&#39;RES SP. K1&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;RES SP. K2&#39;</span><span class="p">,</span> <span class="s1">&#39;RES SP. NS&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Central HP (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;Central Boiler (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;Individual Boiler (24KW) (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;Individual HP 8KW (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;HP (SC)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Central HP (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;Central Boiler (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;Individual Boiler (24KW) (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;Individual HP 8KW (WH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;Share Individual&#39;</span><span class="p">,</span> <span class="s1">&#39;Avg. Dwelling Size&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG SFH Size&#39;</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Solids (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. LPG (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Diesel oil (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Gas heat pumps (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Natural gas (SH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Biomass (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Geothermal (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Distributed heat (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Advanced electric heating (SH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Conventional electric heating (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioOil (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioGas (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Hydrogen (SH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Solar (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electric space cooling (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electricity (SH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Solids (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. LPG (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Diesel oil (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Gas heat pumps (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Natural gas (SC)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Biomass (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Geothermal (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Distributed heat (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Advanced electric heating (SC)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Conventional electric heating (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioOil (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioGas (SH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Hydrogen (SC)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Solar (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electric space cooling (SC)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electricity (SC)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Solids (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. LPG (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Diesel oil (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Gas heat pumps (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Natural gas (WH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Biomass (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Geothermal (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Distributed heat (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Advanced electric heating (WH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Conventional electric heating (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioOil (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioGas (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Hydrogen (WH)&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;EP. Solar (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electric space cooling (WH)&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electricity (WHSH)&#39;</span><span class="p">])],</span>
                      <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 06/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 07 -&gt; Add the input data to the main DataFrame</span>
<div class="viewcode-block" id="s07AddInputDataToMainDataframe">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s07AddInputDataToMainDataframe">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s07AddInputDataToMainDataframe</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                   <span class="n">dfDHW</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                   <span class="n">dfYears</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                   <span class="n">dfSectors</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                   <span class="n">dfDwellings</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                   <span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                                   <span class="n">increaseResidentialBuiltArea</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                                   <span class="n">increaseServiceBuiltArea</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 07: Add the input data to the main DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfDHW: (DataFrame): The DataFrame corresponding to DHW.</span>
<span class="sd">        dfYears (DataFrame): The DataFrame corresponding to Years.</span>
<span class="sd">        dfSectors (DataFrame): The DataFrame corresponding to Sectors.</span>
<span class="sd">        dfDwellings (DataFrame): The DataFrame corresponding to Dwellings.</span>
<span class="sd">        nutsId (str): Identifier of NUTS2 region for which the analysis</span>
<span class="sd">            will be carried out.</span>
<span class="sd">        increaseResidentialBuiltArea (float): Reduction in heating degree</span>
<span class="sd">            days for future scenario.</span>
<span class="sd">        increaseServiceBuiltArea (float): Reduction in cooling degree days</span>
<span class="sd">            for future scenarios.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 07/&gt;  Updating the dataframe information...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfDHW</span><span class="p">[</span><span class="n">dfDHW</span><span class="p">[</span><span class="s1">&#39;BuildingUse&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]][</span><span class="s1">&#39;WWR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Window Area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Total External Facade area&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">value</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Total External Facade area&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Total External Facade area&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfYears</span><span class="p">[</span><span class="n">dfYears</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span>
                                            <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]][</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfDHW</span><span class="p">[</span><span class="n">dfDHW</span><span class="p">[</span><span class="s1">&#39;BuildingUse&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]][</span><span class="s1">&#39;GtH ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">value</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Heated Volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">float</span><span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Number of floors&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">])</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Total External Facade area&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">])</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">dfSectors</span><span class="p">[</span><span class="n">dfSectors</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]][</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">if</span> <span class="n">increaseResidentialBuiltArea</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">increaseServiceBuiltArea</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">gfaResTotal</span><span class="p">,</span> <span class="n">gfaSrvTotal</span><span class="p">,</span> <span class="n">gfaRes2020</span><span class="p">,</span> <span class="n">gfaSrv2020</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">:</span>
                <span class="n">gfaResTotal</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Post-2010&#39;</span><span class="p">:</span>
                    <span class="n">gfaRes2020</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">:</span>
                <span class="n">gfaSrvTotal</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Post-2010&#39;</span><span class="p">:</span>
                    <span class="n">gfaSrv2020</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Post-2010&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">increaseResidentialBuiltArea</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">:</span>
                    <span class="n">gfa</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">gfaRes2020</span> <span class="o">*</span> \
                        <span class="n">gfaResTotal</span> <span class="o">*</span> <span class="n">increaseResidentialBuiltArea</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Gross floor area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gfa</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span>
                             <span class="s1">&#39;Footprint Area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">gfa</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Number of floors&#39;</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span>
                             <span class="s1">&#39;Volume&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="n">gfa</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Number of floors&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Total External Facade area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                        <span class="n">gfa</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">])</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">gfa</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span>
                        <span class="n">dfDHW</span><span class="p">[</span><span class="n">dfDHW</span><span class="p">[</span><span class="s1">&#39;BuildingUse&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]][</span><span class="s1">&#39;WWR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Window Area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">gfa</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">gfa</span> <span class="o">/</span> \
                        <span class="nb">float</span><span class="p">(</span><span class="n">dfDHW</span><span class="p">[</span><span class="n">dfDHW</span><span class="p">[</span><span class="s1">&#39;BuildingUse&#39;</span><span class="p">]</span> <span class="o">==</span>
                              <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]][</span><span class="s1">&#39;GtH ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Heated Volume&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Number of floors&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">increaseServiceBuiltArea</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">:</span>
                    <span class="n">gfa</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Gross floor area&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">gfaSrv2020</span> <span class="o">*</span> \
                        <span class="n">gfaSrvTotal</span> <span class="o">*</span> <span class="n">increaseServiceBuiltArea</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Gross floor area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gfa</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span>
                             <span class="s1">&#39;Footprint Area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">gfa</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Number of floors&#39;</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span>
                             <span class="s1">&#39;Volume&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">((</span><span class="n">gfa</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Number of floors&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Total External Facade area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                        <span class="n">gfa</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">])</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">gfa</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span>
                        <span class="n">dfDHW</span><span class="p">[</span><span class="n">dfDHW</span><span class="p">[</span><span class="s1">&#39;BuildingUse&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]][</span><span class="s1">&#39;WWR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Window Area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">gfa</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Wall to floor ratio&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">gfa</span> <span class="o">/</span> \
                        <span class="nb">float</span><span class="p">(</span><span class="n">dfDHW</span><span class="p">[</span><span class="n">dfDHW</span><span class="p">[</span><span class="s1">&#39;BuildingUse&#39;</span><span class="p">]</span> <span class="o">==</span>
                              <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]][</span><span class="s1">&#39;GtH ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>
                    <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Heated Volume&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Number of floors&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Height&#39;</span><span class="p">])</span>

    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfDwellings</span><span class="p">[</span><span class="n">dfDwellings</span><span class="p">[</span><span class="s1">&#39;CountryID&#39;</span><span class="p">]</span>
                                            <span class="o">==</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Avg. Dwelling Size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfDwellings</span><span class="p">[</span><span class="n">dfDwellings</span><span class="p">[</span><span class="s1">&#39;CountryID&#39;</span><span class="p">]</span>
                                              <span class="o">==</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;AVG SFH Size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfDwellings</span><span class="p">[</span><span class="n">dfDwellings</span><span class="p">[</span><span class="s1">&#39;CountryID&#39;</span><span class="p">]</span>
                                        <span class="o">==</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfDwellings</span><span class="p">[</span><span class="n">dfDwellings</span><span class="p">[</span><span class="s1">&#39;CountryID&#39;</span><span class="p">]</span>
                                          <span class="o">==</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 07/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 08 -&gt; Add the active measures</span>
<div class="viewcode-block" id="s08AddActiveMeasures">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s08AddActiveMeasures">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s08AddActiveMeasures</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                         <span class="n">dfReshhtes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                         <span class="n">dfSerhhtes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                         <span class="n">dfRThheff</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                         <span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">activeMeasures</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                         <span class="n">activeMeasuresBaseline</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                         <span class="n">archetypes</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 08: Add the active measures.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfReshhtes (DataFrame): The DataFrame corresponding to Residential.</span>
<span class="sd">        dfSerhhtes (DataFrame): The DataFrame corresponding to Service.</span>
<span class="sd">        dfRThheff (DataFrame): The DataFrame corresponding to RT.</span>
<span class="sd">        nutsId: str -&gt; Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">        activeMeasures (list): The list of active measures::</span>
<span class="sd">            </span>
<span class="sd">            Example: see &quot;input.json&quot; file in the root directory.</span>
<span class="sd">        </span>
<span class="sd">        activeMeasuresBaseline (list): The list of active measures corresponding to the baseline::</span>

<span class="sd">            Example: see &quot;input.json&quot; file in the root directory.</span>
<span class="sd">        </span>
<span class="sd">        archetypes (list): The list of building uses. Example::</span>

<span class="sd">            &quot;[</span>
<span class="sd">                &quot;Apartment Block&quot;,</span>
<span class="sd">                &quot;Single family- Terraced houses&quot;,</span>
<span class="sd">                &quot;Hotels and Restaurants&quot;,</span>
<span class="sd">                &quot;Health&quot;,</span>
<span class="sd">                &quot;Education&quot;,</span>
<span class="sd">                &quot;Offices&quot;,</span>
<span class="sd">                &quot;Trade&quot;,</span>
<span class="sd">                &quot;Other non-residential buildings&quot;,</span>
<span class="sd">                &quot;Sport&quot;</span>
<span class="sd">            ]&quot;</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>
            

    <span class="n">dfReshhtes</span> <span class="o">=</span> <span class="n">dfReshhtes</span><span class="p">[[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;Energy service&#39;</span><span class="p">,</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]]</span>
    <span class="n">dfSerhhtes</span> <span class="o">=</span> <span class="n">dfSerhhtes</span><span class="p">[[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;Energy service&#39;</span><span class="p">,</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]]</span>
    <span class="n">dfRThheff</span> <span class="o">=</span> <span class="n">dfRThheff</span><span class="p">[[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Energy service&#39;</span><span class="p">,</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 08/&gt;  Writing the Active measures...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">activeMeasures</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;user_defined_data&#39;</span><span class="p">]:</span>
            <span class="c1"># Space heating</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Space heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Biomass&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Conventional electric heating&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electricity in circulation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SH. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electricity&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;solids&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;lpg&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;diesel_oil&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;gas_heat_pumps&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;natural_gas&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;biomass&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;geothermal&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;distributed_heat&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;advanced_electric_heating&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;conventional_electric_heating&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_oil&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_gas&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;hydrogen&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;electricity_in_circulation&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
            <span class="p">]</span>
            <span class="c1"># Space cooling</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Biomass&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SC. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Conventional electric heating&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SC. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electricity in circulation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SC. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electricity&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_cooling&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_cooling&#39;</span><span class="p">][</span><span class="s1">&#39;gas_heat_pumps&#39;</span><span class="p">],</span>
                <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span>
                    <span class="s1">&#39;space_cooling&#39;</span><span class="p">][</span><span class="s1">&#39;electric_space_cooling&#39;</span><span class="p">],</span> <span class="mf">0.0</span>
            <span class="p">]</span>
            <span class="c1"># Water heating</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Water heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Biomass&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WH. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Conventional electric heating&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WH. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electricity in circulation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WH. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electricity&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;solids&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;lpg&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;diesel_oil&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;natural_gas&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;biomass&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;geothermal&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;distributed_heat&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;advanced_electric_heating&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_oil&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_gas&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;hydrogen&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;solar&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="c1"># Cooking</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Cooking&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;C. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Biomass&#39;</span><span class="p">,</span>
                <span class="s1">&#39;C. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Conventional electric heating&#39;</span><span class="p">,</span>
                <span class="s1">&#39;C. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;C. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electricity in circulation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;C. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electricity&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;solids&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;lpg&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;natural_gas&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;biomass&#39;</span><span class="p">],</span>
                <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="c1"># Lighting</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Lighting&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;L. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Biomass&#39;</span><span class="p">,</span>
                <span class="s1">&#39;L. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Conventional electric heating&#39;</span><span class="p">,</span>
                <span class="s1">&#39;L. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;L. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electricity in circulation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;L. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electricity&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;lighting&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;lighting&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="c1"># Appliances</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Appliances&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;A. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Biomass&#39;</span><span class="p">,</span>
                <span class="s1">&#39;A. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Conventional electric heating&#39;</span><span class="p">,</span>
                <span class="s1">&#39;A. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;A. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electricity in circulation&#39;</span><span class="p">,</span>
                <span class="s1">&#39;A. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electricity&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
                <span class="c1"># Space heating (for Residential and Service sectors)</span>
                <span class="n">space_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Space heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Space heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solids&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Space heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. LPG&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Diesel oil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Gas heat pumps&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Natural gas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Biomass&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Geothermal&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Distributed heat&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Space heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Advanced electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Space heating_Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Conventional electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioOil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioGas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Hydrogen&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solar&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Electricity in circulation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Electricity in circulation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electricity in circulation&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electric space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electricity&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Space cooling (for Residential and Service sectors)</span>
                <span class="n">space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solids&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. LPG&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Diesel oil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space cooling_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space cooling_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Gas heat pumps&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Natural gas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Biomass&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Geothermal&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Distributed heat&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Advanced electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Conventional electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioOil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioGas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Hydrogen&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solar&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electricity in circulation&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space cooling_Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space cooling_Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electric space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electricity&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Water heating (for Residential and Service sectors)</span>
                <span class="n">water_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solids&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Water heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. LPG&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Diesel oil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Gas heat pumps&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Natural gas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Biomass&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Geothermal&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Distributed heat&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Water heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Advanced electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Conventional electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioOil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioGas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Hydrogen&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solar&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electric space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electric space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electricity&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Cooking (for Residential and Service sectors)</span>
                <span class="n">cooking</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Cooking&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Solids&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. LPG&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Diesel oil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Gas heat pumps&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_natural_gass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Natural gas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Biomass&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Geothermal&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Distributed heat&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Advanced electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Conventional electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. BioOil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. BioGas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Hydrogen&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Solar&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Electricity in circulation&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Electric space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Electricity&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Lighting (for Residential and Service sectors)</span>
                <span class="n">lighting</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Lighting&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Solids&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. LPG&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Diesel oil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Gas heat pumps&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Natural gas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Biomass&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Geothermal&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Distributed heat&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Advanced electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Conventional electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. BioOil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. BioGas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Hydrogen&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Solar&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electricity in circulation&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electric space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electricity&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Appliances (for Residential and Service sectors)</span>
                <span class="n">appliances</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Appliances&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Solids&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. LPG&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;a. Diesel oil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Gas heat pumps&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Natural gas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Biomass&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Geothermal&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Distributed heat&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Advanced electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Conventional electric heating&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. BioOil&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. BioGas&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Hydrogen&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Solar&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Electricity in circulation&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Electric space cooling&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electricity&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 08/&gt;  Writing the Active measures (baseline)...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">activeMeasuresBaseline</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;user_defined_data&#39;</span><span class="p">]:</span>
            <span class="c1"># Space heating</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Space heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Gas heat pumps base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SH. Natural gas base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Distributed heat base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SH. Advanced electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. BioGas base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SH. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Solar base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Electric space cooling base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SH. Electricity base&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;solids&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;lpg&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;diesel_oil&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;gas_heat_pumps&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;natural_gas&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;biomass&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;geothermal&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;distributed_heat&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;advanced_electric_heating&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;conventional_electric_heating&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_oil&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_gas&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;hydrogen&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_heating&#39;</span><span class="p">][</span><span class="s1">&#39;electricity_in_circulation&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
            <span class="p">]</span>
            <span class="c1"># Space cooling</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Gas heat pumps base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SC. Natural gas base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Distributed heat base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SC. Advanced electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. BioGas base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SC. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Solar base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Electric space cooling base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;SC. Electricity base&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_cooling&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;space_cooling&#39;</span><span class="p">][</span><span class="s1">&#39;gas_heat_pumps&#39;</span><span class="p">],</span>
                <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span>
                    <span class="s1">&#39;space_cooling&#39;</span><span class="p">][</span><span class="s1">&#39;electric_space_cooling&#39;</span><span class="p">],</span> <span class="mf">0.0</span>
            <span class="p">]</span>
            <span class="c1"># Water heating</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Water heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Gas heat pumps base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WH. Natural gas base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Distributed heat base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WH. Advanced electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. BioGas base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WH. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Solar base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Electric space cooling base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;WH. Electricity base&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;solids&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;lpg&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;diesel_oil&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;natural_gas&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;biomass&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;geothermal&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;distributed_heat&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;advanced_electric_heating&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_oil&#39;</span><span class="p">],</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;bio_gas&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;hydrogen&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;solar&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;water_heating&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="c1"># Cooking</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Cooking base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Gas heat pumps base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Natural gas base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;C. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Distributed heat base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Advanced electric heating base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;C. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. BioGas base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Solar base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;C. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electric space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;C. Electricity base&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;solids&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;lpg&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;natural_gas&#39;</span><span class="p">],</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;biomass&#39;</span><span class="p">],</span>
                <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;cooking&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="c1"># Lighting</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Lighting base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Gas heat pumps base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Natural gas base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;L. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Distributed heat base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Advanced electric heating base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;L. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. BioGas base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Solar base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;L. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electric space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;L. Electricity base&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;lighting&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;lighting&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
            <span class="c1"># Appliances</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span> <span class="p">[</span>
                <span class="s1">&#39;Appliances base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solids base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. LPG base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Diesel oil base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Gas heat pumps base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Natural gas base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;A. Biomass base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Geothermal base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Distributed heat base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Advanced electric heating base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;A. Conventional electric heating base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. BioOil base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. BioGas base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Hydrogen base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Solar base&#39;</span><span class="p">,</span>
                <span class="s1">&#39;A. Electricity in circulation base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electric space cooling base&#39;</span><span class="p">,</span> <span class="s1">&#39;A. Electricity base&#39;</span>
            <span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="s1">&#39;pct_build_equipped&#39;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;appliances&#39;</span><span class="p">][</span><span class="s1">&#39;electricity&#39;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
                <span class="c1"># Space heating (for Residential and Service sectors)</span>
                <span class="n">space_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Space heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Space heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solids base base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Space heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. LPG base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Diesel oil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Gas heat pumps base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Natural gas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Biomass base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Geothermal base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Distributed heat base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Space heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Advanced electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Space heating_Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Conventional electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioOil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioGas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Hydrogen base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solar base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Electricity in circulation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Electricity in circulation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electricity in circulation base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electric space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sh_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electricity base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Space cooling (for Residential and Service sectors)</span>
                <span class="n">space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solids base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. LPG base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Diesel oil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space cooling_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space cooling_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Gas heat pumps base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Natural gas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Biomass base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Geothermal base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Distributed heat base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Advanced electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Conventional electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioOil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioGas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Hydrogen base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solar base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electricity in circulation base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Space cooling_Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space cooling_Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electric space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">sc_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electricity base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Water heating (for Residential and Service sectors)</span>
                <span class="n">water_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solids base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Water heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. LPG base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Diesel oil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Gas heat pumps base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Natural gas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Biomass base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Geothermal base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Distributed heat base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Water heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Advanced electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Conventional electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioOil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioGas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Hydrogen base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solar base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electric space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electric space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">wh_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Water heating_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electricity base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Cooking (for Residential and Service sectors)</span>
                <span class="n">cooking</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Cooking base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Solids base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. LPG base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Diesel oil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Gas heat pumps base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_natural_gass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Natural gas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Biomass base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Geothermal base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Distributed heat base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Advanced electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Conventional electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. BioOil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. BioGas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Hydrogen base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Solar base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Electricity in circulation base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Electric space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">c_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Cooking_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Cooking_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;C. Electricity base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Lighting (for Residential and Service sectors)</span>
                <span class="n">lighting</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Lighting base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Solids base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. LPG base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Diesel oil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Gas heat pumps base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Natural gas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Biomass base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Geothermal base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Distributed heat base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Advanced electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Conventional electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. BioOil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. BioGas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Hydrogen base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Solar base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electricity in circulation base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electric space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">l_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electricity base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="c1"># Appliances (for Residential and Service sectors)</span>
                <span class="n">appliances</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;_Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Appliances base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_solids</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Solids base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_lpg</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. LPG base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_diesel_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;a. Diesel oil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_gas_heat_pumps</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Gas heat pumps base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_natural_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Natural gas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_biomass</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Biomass base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_geothermal</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Geothermal base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_distributed_heat</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Distributed heat base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_advanced_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Advanced electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_conventional_electric_heating</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Conventional electric heating base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_bio_oil</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. BioOil base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_bio_gas</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. BioGas base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_hydrogen</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Hydrogen base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_solar</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Solar base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_electricity_in_circulation</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Electricity in circulation base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_electric_space_cooling</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="mf">0.0</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;A. Electric space cooling base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">a_electricity</span><span class="o">=</span><span class="n">dfCSV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">dfReshhtes</span><span class="p">[</span><span class="n">dfReshhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                           <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">(</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="n">dfSerhhtes</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Service&#39;</span><span class="p">)</span>
                          <span class="k">else</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;L. Electricity base&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Energy services (dfRThheff)</span>
    <span class="k">for</span> <span class="n">arch</span> <span class="ow">in</span> <span class="n">archetypes</span><span class="p">:</span>
        <span class="c1"># Space heating</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                                               <span class="o">==</span> <span class="s1">&#39;_Space heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Solids&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Space heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. LPG&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Diesel oil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Natural gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Space heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Geothermal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Distributed heat&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space heating_Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. BioOil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Space heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. BioGas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Space heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SH. Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Space heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Electricity in circulation</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. EIC&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;_Electricity in circulation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Space cooling</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                                               <span class="o">==</span> <span class="s1">&#39;_Space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SC. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space cooling_Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. SC. Electric space cooling&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Space cooling_Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Water heating</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                                               <span class="o">==</span> <span class="s1">&#39;_Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Solids&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Water heating_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. LPG&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Water heating_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Diesel oil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Water heating_Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Natural gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Water heating_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Water heating_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Geothermal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Water heating_Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Distributed heat&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Water heating_Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Water heating_Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Water heating_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. BioOil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Water heating_BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. BioGas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Water heating_BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Water heating_Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. WH. Solar&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Water heating_Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Cooking</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span>
                  <span class="s1">&#39;Eff. C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Solids&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Cooking_Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. C. LPG&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span>
                      <span class="s1">&#39;Cooking_Liquified petroleum gas (LPG)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Natural gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Cooking_Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Cooking_Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. C. Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Cooking_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Lighting</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span>
                  <span class="s1">&#39;Eff. L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. L. Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Lighting_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Appliances</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                                                              <span class="o">==</span> <span class="s1">&#39;_Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Eff. A. Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dfRThheff</span><span class="p">[</span><span class="n">dfRThheff</span><span class="p">[</span><span class="s1">&#39;Energy service_Fuel&#39;</span><span class="p">]</span>
                      <span class="o">==</span> <span class="s1">&#39;Appliances_Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 08/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 09 -&gt; Add the passive measures</span>
<div class="viewcode-block" id="s09AddPassiveMeasures">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s09AddPassiveMeasures">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s09AddPassiveMeasures</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                          <span class="n">passiveMeasures</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 09: Add the passive measures.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        passiveMeasures (list): The list of passive measures::</span>

<span class="sd">            Example: see &quot;input.json&quot; file in the root directory.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 09/&gt;  Writing the Passive measures...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">passiveMeasures</span><span class="p">:</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;Ref Level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;ref_level&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Pre-1945&#39;</span><span class="p">),</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;percentages_by_periods&#39;</span><span class="p">][</span><span class="s1">&#39;Pre-1945&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1945-1969&#39;</span><span class="p">),</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;percentages_by_periods&#39;</span><span class="p">][</span><span class="s1">&#39;1945-1969&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1970-1979&#39;</span><span class="p">),</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;percentages_by_periods&#39;</span><span class="p">][</span><span class="s1">&#39;1970-1979&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1980-1989&#39;</span><span class="p">),</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;percentages_by_periods&#39;</span><span class="p">][</span><span class="s1">&#39;1980-1989&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1990-1999&#39;</span><span class="p">),</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;percentages_by_periods&#39;</span><span class="p">][</span><span class="s1">&#39;1990-1999&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2000-2010&#39;</span><span class="p">),</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;percentages_by_periods&#39;</span><span class="p">][</span><span class="s1">&#39;2000-2010&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;building_use&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Post-2010&#39;</span><span class="p">),</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">measure</span><span class="p">[</span><span class="s1">&#39;percentages_by_periods&#39;</span><span class="p">][</span><span class="s1">&#39;Post-2010&#39;</span><span class="p">]</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 09/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 10 -&gt; Write the U-Values and the Internal Gains</span>
<div class="viewcode-block" id="s10WriteUValuesAndInternalGains">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s10WriteUValuesAndInternalGains">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s10WriteUValuesAndInternalGains</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                    <span class="n">dfDHW</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                    <span class="n">dfUValues</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                    <span class="n">dfRUValues</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                    <span class="n">dfACH</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                    <span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 10: Write the U-Values and the Internal Gains.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfDHW (DataFrame): The DataFrame corresponding to DHW.</span>
<span class="sd">        dfUValues (DataFrame): The DataFrame corresponding to U-Values.</span>
<span class="sd">        dfRUValues (DataFrame): The DataFrame corresponding to Retroffitting U-Values.</span>
<span class="sd">        dfACH (DataFrame): The DataFrame corresponding to ACH.</span>
<span class="sd">        nutsId (str) :Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 10/&gt;  Writing the U-Values and the Internal Gains...&#39;</span><span class="p">)</span>
    <span class="n">country</span> <span class="o">=</span> <span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="c1"># U-Values</span>
        <span class="n">sector</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]</span>
        <span class="n">dfRUV</span> <span class="o">=</span> <span class="n">dfRUValues</span><span class="p">[</span><span class="n">dfRUValues</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref Level&#39;</span><span class="p">]]</span>
        <span class="n">dfRUV</span> <span class="o">=</span> <span class="n">dfRUV</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dfq</span> <span class="o">=</span> <span class="n">dfUValues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
            <span class="s1">&#39;Country_ID == @country and Sector == @sector and Period == @period&#39;</span><span class="p">)</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Roof [W/m2K]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfq</span><span class="p">[</span><span class="s1">&#39;Roof&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">dfRUV</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>\
            <span class="o">*</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dfq</span><span class="p">[</span><span class="s1">&#39;Roof&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]))</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Wall [W/m2K]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">dfq</span><span class="p">[</span><span class="s1">&#39;Wall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">dfRUV</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>\
            <span class="o">*</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dfq</span><span class="p">[</span><span class="s1">&#39;Wall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]))</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Window [W/m2K]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfRUV</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="nb">float</span><span class="p">(</span><span class="n">dfq</span><span class="p">[</span><span class="s1">&#39;Window&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">])</span>

        <span class="c1"># Internal Gains</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">dfDHW</span><span class="p">[</span><span class="n">dfDHW</span><span class="p">[</span><span class="s1">&#39;BuildingUse&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Equipment internal gains [W/m2]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                   <span class="s1">&#39;Equipment internal gains [W/m2]&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occupancy internal gains [W/m2]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                   <span class="s1">&#39;Occupancy internal gains [W/m2]&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Lighting power [W/m2]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                         <span class="s1">&#39;Lighting power [W/m2]&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DHW demand [KW/m2·year]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                           <span class="s1">&#39;Anual DHW demand (KWh/m2)&#39;</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Cooking [KW/m2·year]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                        <span class="s1">&#39;Cooking [KWh/m2·year]&#39;</span><span class="p">]</span>
        <span class="n">ach</span> <span class="o">=</span> <span class="n">dfACH</span><span class="p">[</span><span class="n">dfACH</span><span class="p">[</span><span class="s1">&#39;Country_ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">country</span><span class="p">][</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Period&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Air renovation losses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ach</span> <span class="o">*</span> \
            <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">])</span> <span class="o">+</span> \
            <span class="nb">min</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.2</span><span class="p">)</span> <span class="o">*</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Ref%&#39;</span><span class="p">]</span>

    <span class="c1"># Common factors</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;D-Factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Footprint Area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Roof [W/m2K]&#39;</span><span class="p">]</span> <span class="o">+</span>\
        <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Wall [W/m2K]&#39;</span><span class="p">]</span> <span class="o">+</span>\
        <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Window Area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Window [W/m2K]&#39;</span><span class="p">]</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;IG-Li-Factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Lighting power [W/m2]&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;IG-Eq-Factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Equipment internal gains [W/m2]&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;IG-Oc-Factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Occupancy internal gains [W/m2]&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span>
    <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;ARL-Factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.33</span> <span class="o">*</span> \
        <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Air renovation losses&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Heated Volume&#39;</span><span class="p">]</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 10/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 11 -&gt; Add the CAPEX dataframe</span>
<div class="viewcode-block" id="s11AddCapexDataFrame">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s11AddCapexDataFrame">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s11AddCapexDataFrame</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                         <span class="n">dfBesCapex</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 11: Add the CAPEX dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfBesCapex (DataFrame): The DataFrame corresponding to Capex.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 11/&gt;  Adding the CAPEX dataframe...&#39;</span><span class="p">)</span>

    <span class="c1"># Space heating</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;CAPEX SH. Solids&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. LPG&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                            <span class="s1">&#39;Liquified petroleum gas (LPG)&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Diesel oil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Gas heat pumps&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                       <span class="s1">&#39;Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Natural gas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                    <span class="s1">&#39;Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Geothermal&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Distributed heat&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Advanced electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                  <span class="s1">&#39;Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Conventional electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                      <span class="s1">&#39;Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. BioOil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. BioGas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                 <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Electric space cooling&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                               <span class="s1">&#39;Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                    <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SH. Solar&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Space cooling</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;CAPEX SC. Solids&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. LPG&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                            <span class="s1">&#39;Liquified petroleum gas (LPG)&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Diesel oil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Gas heat pumps&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                       <span class="s1">&#39;Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Natural gas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                    <span class="s1">&#39;Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Geothermal&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Distributed heat&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Advanced electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                  <span class="s1">&#39;Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Conventional electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                      <span class="s1">&#39;Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. BioOil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. BioGas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                 <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Electric space cooling&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                               <span class="s1">&#39;Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                    <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX SC. Solar&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Water heating</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;CAPEX WH. Solids&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. LPG&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                            <span class="s1">&#39;Liquified petroleum gas (LPG)&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Diesel oil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Gas heat pumps&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                       <span class="s1">&#39;Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Natural gas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                    <span class="s1">&#39;Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Geothermal&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Distributed heat&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Advanced electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                  <span class="s1">&#39;Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Conventional electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                      <span class="s1">&#39;Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. BioOil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. BioGas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                 <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Electric space cooling&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                               <span class="s1">&#39;Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                    <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX WH. Solar&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Water Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Cooking</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;CAPEX C. Solids&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. LPG&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Liquified petroleum gas (LPG)&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Diesel oil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                  <span class="s1">&#39;Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Gas heat pumps&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                      <span class="s1">&#39;Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Natural gas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Geothermal&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                  <span class="s1">&#39;Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Distributed heat&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Advanced electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                 <span class="s1">&#39;Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Conventional electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                     <span class="s1">&#39;Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. BioOil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. BioGas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Electric space cooling&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                              <span class="s1">&#39;Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX C. Solar&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                             <span class="s1">&#39;Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Lighting</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;CAPEX L. Solids&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. LPG&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Liquified petroleum gas (LPG)&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Diesel oil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                  <span class="s1">&#39;Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Gas heat pumps&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                      <span class="s1">&#39;Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Natural gas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Geothermal&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                  <span class="s1">&#39;Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Distributed heat&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Advanced electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                 <span class="s1">&#39;Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Conventional electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                     <span class="s1">&#39;Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. BioOil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. BioGas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Electric space cooling&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                              <span class="s1">&#39;Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX L. Solar&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                             <span class="s1">&#39;Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Appliances</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;CAPEX A. Solids&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. LPG&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                           <span class="s1">&#39;Liquified petroleum gas (LPG)&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Diesel oil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                  <span class="s1">&#39;Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Gas heat pumps&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                      <span class="s1">&#39;Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Natural gas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                               <span class="s1">&#39;Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Geothermal&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                  <span class="s1">&#39;Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Distributed heat&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Advanced electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                 <span class="s1">&#39;Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Conventional electric heating&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                     <span class="s1">&#39;Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. BioOil&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. BioGas&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                              <span class="s1">&#39;BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Electric space cooling&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                              <span class="s1">&#39;Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                   <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;CAPEX A. Solar&#39;</span><span class="p">:</span> <span class="n">dfBesCapex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesCapex</span><span class="p">[</span><span class="s1">&#39;Building Energy System CAPEX E/KW&#39;</span><span class="p">]</span> <span class="o">==</span>
                                             <span class="s1">&#39;Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 11/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 12 -&gt; Add the OPEX dataframe</span>
<div class="viewcode-block" id="s12AddOpexDataFrame">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s12AddOpexDataFrame">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s12AddOpexDataFrame</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                        <span class="n">dfBesOpex</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 12: Add the OPEX dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfBesOpex (DataFrame): The DataFrame corresponding to Opex.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 12/&gt;  Adding the OPEX dataframe...&#39;</span><span class="p">)</span>

    <span class="c1"># Fixed cost</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;OPEX Fixed cost Solids|Coal&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Liquids|Gas&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Liquids|Oil&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Liquids|Oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Gases|Gas&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                       <span class="s1">&#39;Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Solids|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                            <span class="s1">&#39;Solids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Heat&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                  <span class="s1">&#39;Heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Liquids|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                             <span class="s1">&#39;Liquids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Gases|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                           <span class="s1">&#39;Gases|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                      <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Fixed cost Heat|Solar&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Heat|Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Fixed cost E/KW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Variable cost</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;OPEX Variable cost Solids|Coal&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                            <span class="s1">&#39;Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Liquids|Gas&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                            <span class="s1">&#39;Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Liquids|Oil&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                            <span class="s1">&#39;Liquids|Oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Gases|Gas&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                          <span class="s1">&#39;Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Solids|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                               <span class="s1">&#39;Solids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                            <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Heat&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                     <span class="s1">&#39;Heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Liquids|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                                <span class="s1">&#39;Liquids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Gases|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                              <span class="s1">&#39;Gases|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                         <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Variable cost Heat|Solar&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                           <span class="s1">&#39;Heat|Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost E/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Emissions</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;OPEX Emissions Solids|Coal&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Liquids|Gas&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Liquids|Oil&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Liquids|Oil&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Gases|Gas&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                      <span class="s1">&#39;Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Solids|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                           <span class="s1">&#39;Solids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Electricity&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                        <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Heat&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                 <span class="s1">&#39;Heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Liquids|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                            <span class="s1">&#39;Liquids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Gases|Biomass&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                          <span class="s1">&#39;Gases|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Hydrogen&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                     <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;OPEX Emissions Heat|Solar&#39;</span><span class="p">:</span> <span class="n">dfBesOpex</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfBesOpex</span><span class="p">[</span><span class="s1">&#39;Building Energy System OPEX&#39;</span><span class="p">]</span> <span class="o">==</span>
                                                       <span class="s1">&#39;Heat|Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Emisions kgCO2/KWh&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 12/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 13 -&gt; Add the Retrofitting Cost dataframe</span>
<div class="viewcode-block" id="s13AddRetrofittingCostDataFrame">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s13AddRetrofittingCostDataFrame">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s13AddRetrofittingCostDataFrame</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                    <span class="n">dfRetroCost</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 13: Add the Retrofitting Cost dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfRetroCost (DataFrame): The DataFrame corresponding to Retrofitting Cost.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 13/&gt;  Adding the Retrofitting Cost dataframe...&#39;</span><span class="p">)</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;RFC Cost Low Wall&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Wall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost Medium Wall&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Wall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost High Wall&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Wall&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost Low Roof&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Roof&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost Medium Roof&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Roof&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost High Roof&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Roof&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost Low Window&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Window&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost Medium Window&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Window&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RFC Cost High Window&#39;</span><span class="p">:</span> <span class="n">dfRetroCost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRetroCost</span><span class="p">[</span><span class="s1">&#39;Level&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Window&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 13/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 14 -&gt; Add the Renewable Energy Systems dataframe</span>
<div class="viewcode-block" id="s14AddRenewableEnergySystemsDataFrame">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s14AddRenewableEnergySystemsDataFrame">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s14AddRenewableEnergySystemsDataFrame</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                          <span class="n">dfRes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 14: Add the Renewable Energy Systems dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfRes (DataFrame): The DataFrame corresponding to Renewable Energy Systems.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 14/&gt;  Adding the Renewable Energy Systems (RES) dataframe...&#39;</span><span class="p">)</span>
    <span class="n">dfCSV</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="o">**</span><span class="p">{</span>
            <span class="s1">&#39;RES ST. Cost&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Cost (E/m2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES ST. Impact&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Impact (kgCO2/m2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES ST. Lifetime&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Lifetime (years)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES ST. Efficiency&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;Efficiency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES ST. N0&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;n0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES ST. K1&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;k1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES ST. K2&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES ST. NS&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Thermal&#39;</span><span class="p">,</span> <span class="s1">&#39;ns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. Cost&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;Cost (E/m2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. Impact&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;Impact (kgCO2/m2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. Lifetime&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;Lifetime (years)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. Efficiency&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;Efficiency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. N0&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;n0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. K1&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;k1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. K2&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;RES SP. NS&#39;</span><span class="p">:</span> <span class="n">dfRes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfRes</span><span class="p">[</span><span class="s1">&#39;RES&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Solar Photovoltaic&#39;</span><span class="p">,</span> <span class="s1">&#39;ns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 14/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 15 -&gt; Add the Capacity dataframe</span>
<div class="viewcode-block" id="s15AddCapacityDataFrame">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s15AddCapacityDataFrame">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s15AddCapacityDataFrame</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                            <span class="n">dfCapacity</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                            <span class="n">archetypes</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 15: Add the Capacity dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfCapacity (DataFrame): The DataFrame corresponding to Capacity.</span>
<span class="sd">        archetypes (list): The list of building uses. Example::</span>

<span class="sd">            &quot;[</span>
<span class="sd">                &quot;Apartment Block&quot;,</span>
<span class="sd">                &quot;Single family- Terraced houses&quot;,</span>
<span class="sd">                &quot;Hotels and Restaurants&quot;,</span>
<span class="sd">                &quot;Health&quot;,</span>
<span class="sd">                &quot;Education&quot;,</span>
<span class="sd">                &quot;Offices&quot;,</span>
<span class="sd">                &quot;Trade&quot;,</span>
<span class="sd">                &quot;Other non-residential buildings&quot;,</span>
<span class="sd">                &quot;Sport&quot;</span>
<span class="sd">            ]&quot;</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 15/&gt;  Adding the Capacity dataframe...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">arch</span> <span class="ow">in</span> <span class="n">archetypes</span><span class="p">:</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Central HP (SH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating&#39;</span><span class="p">)</span>
                                                                            <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Central HP&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Central Boiler (SH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating&#39;</span><span class="p">)</span>
                                                                                <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Central Boiler&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Individual Boiler (24KW) (SH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating&#39;</span><span class="p">)</span>
                                                                                          <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Individual Boiler (24KW)&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Individual HP 8KW (SH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space heating&#39;</span><span class="p">)</span>
                                                                                   <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Individual HP 8KW&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;HP (SC)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Space cooling&#39;</span><span class="p">)</span>
                                                                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HP&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Central HP (WH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating&#39;</span><span class="p">)</span>
                                                                            <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Central HP&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Central Boiler (WH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating&#39;</span><span class="p">)</span>
                                                                                <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Central Boiler&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Individual Boiler (24KW) (WH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating&#39;</span><span class="p">)</span>
                                                                                          <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Individual Boiler (24KW)&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">arch</span><span class="p">,</span> <span class="s1">&#39;Individual HP 8KW (WH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfCapacity</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Energy Service&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Water heating&#39;</span><span class="p">)</span>
                                                                                   <span class="o">&amp;</span> <span class="p">(</span><span class="n">dfCapacity</span><span class="p">[</span><span class="s1">&#39;Capacity KW/m2&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Individual HP 8KW&#39;</span><span class="p">),</span> <span class="n">arch</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 15/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 16 -&gt; Add the Equivalent Power dataframe</span>
<div class="viewcode-block" id="s16AddEquivalentPowerDataFrame">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s16AddEquivalentPowerDataFrame">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s16AddEquivalentPowerDataFrame</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 16: Add the Equivalent Power dataframe.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 16/&gt;  Adding the Equivalent Power dataframe...&#39;</span><span class="p">)</span>

    <span class="n">centralHPColumns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;EP. Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Advanced electric heating&#39;</span><span class="p">]</span>
    <span class="n">centralBoilerColumns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;EP. LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Natural gas&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;EP. Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Distributed heat&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;EP. Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Hydrogen&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;EP. Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;EP. Electricity&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">centralHP</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Central HP (SH)&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;HP (SC)&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Central Boiler (WH)&#39;</span><span class="p">]]</span>
        <span class="n">centralBoiler</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Central Boiler (SH)&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;HP (SC)&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Central Boiler (WH)&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Apartment Block&#39;</span><span class="p">:</span>
            <span class="n">centralHP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">centralHP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">])</span> <span class="o">+</span> \
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Individual HP 8KW (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">]</span>
            <span class="n">centralHP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">centralHP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">])</span> <span class="o">+</span> \
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Individual Boiler (24KW) (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">]</span>
            <span class="n">centralBoiler</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">centralBoiler</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">])</span> <span class="o">+</span> \
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Individual Boiler (24KW) (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">]</span>
            <span class="n">centralBoiler</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">centralBoiler</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Central Boiler (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Share Individual&#39;</span><span class="p">]</span>

        <span class="c1"># Space heating</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;EP. Solids (SH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralBoiler</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e+06</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">centralHPColumns</span><span class="p">:</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; (SH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralHP</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">centralBoilerColumns</span><span class="p">:</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; (SH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralBoiler</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>

        <span class="c1"># Space cooling</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;EP. Solids (SC)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralHP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">centralHPColumns</span><span class="p">:</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; (SC)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralHP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">centralBoilerColumns</span><span class="p">:</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; (SC)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralHP</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>

        <span class="c1"># Water heating</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;EP. Solids (WH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralHP</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">centralHPColumns</span><span class="p">:</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; (WH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralHP</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">centralBoilerColumns</span><span class="p">:</span>
            <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="s1">&#39; (WH)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">centralHP</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">6</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 16/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 17 -&gt; Calculate the costs</span>
<div class="viewcode-block" id="s17CalculateCosts">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s17CalculateCosts">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s17CalculateCosts</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 17: Calculate the costs.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 17/&gt;  Calculating the costs...&#39;</span><span class="p">)</span>
    <span class="n">dfDwellings</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[[</span><span class="s1">&#39;Sector&#39;</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]]</span>
    <span class="n">dfDwellings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfDwellings</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span> <span class="o">!=</span>
                    <span class="s1">&#39;Residential&#39;</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="c1"># Space heating</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Solids&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Solids (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solids&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solids base&#39;</span><span class="p">])</span> <span class="o">/</span>  <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Solids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. LPG&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. LPG (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. LPG&#39;</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. LPG base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost LPG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Diesel oil&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Diesel oil (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Diesel oil&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Diesel oil base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Diesel oil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Gas heat pumps (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Gas heat pumps base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Natural gas&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Natural gas (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Natural gas&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Natural gas base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Natural gas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Biomass&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Biomass (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Biomass&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Biomass base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Biomass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Geothermal&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Geothermal (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Geothermal&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Geothermal base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Geothermal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Distributed heat&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Distributed heat (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Distributed heat&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Distributed heat base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Distributed heat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Advanced electric heating (SH)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Advanced electric heating base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Conventional electric heating (SH)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Conventional electric heating base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. BioOil&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. BioOil (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioOil&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioOil base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost BioOil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. BioGas&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. BioGas (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioGas&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. BioGas base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost BioGas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Hydrogen&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Hydrogen (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Hydrogen&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Hydrogen base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Solar&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Solar (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solar&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Solar base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Electric space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Electric space cooling (SH)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electric space cooling&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electric space cooling base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Electric space cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SH. Electricity&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Electricity (SH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electricity&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Electricity base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Electricity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>

        <span class="c1"># Space cooling</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Solids&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Solids (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solids&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solids base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Solids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. LPG&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. LPG (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. LPG&#39;</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. LPG base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost LPG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Diesel oil&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Diesel oil (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Diesel oil&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Diesel oil base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Diesel oil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Gas heat pumps (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Gas heat pumps base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Natural gas&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Natural gas (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Natural gas&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Natural gas base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Natural gas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Biomass&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Biomass (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Biomass&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Biomass base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Biomass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Geothermal&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Geothermal (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Geothermal&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Geothermal base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Geothermal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Distributed heat&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Distributed heat (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Distributed heat&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Distributed heat base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Distributed heat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Advanced electric heating (SC)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Advanced electric heating base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Conventional electric heating (SC)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Conventional electric heating base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. BioOil&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. BioOil (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioOil&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioOil base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioOil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. BioGas&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. BioGas (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioGas&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. BioGas base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioGas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Hydrogen&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Hydrogen (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Hydrogen&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Hydrogen base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Solar&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Solar (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solar&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Solar base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Electric space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Electric space cooling (SC)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electric space cooling&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electric space cooling base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Electric space cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX SC. Electricity&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Electricity (SC)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electricity&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Electricity base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Electricity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>

        <span class="c1"># Water heating</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Solids&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Solids (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solids&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solids base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Solids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. LPG&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. LPG (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. LPG&#39;</span><span class="p">]</span> <span class="o">-</span>
                                   <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. LPG base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost LPG&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Diesel oil&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Diesel oil (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Diesel oil&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Diesel oil base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Diesel oil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Gas heat pumps (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Gas heat pumps base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Natural gas&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Natural gas (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Natural gas&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Natural gas base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Natural gas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Biomass&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Biomass (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Biomass&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Biomass base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Biomass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Geothermal&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Geothermal (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Geothermal&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Geothermal base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Geothermal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Distributed heat&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Distributed heat (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Distributed heat&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Distributed heat base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Distributed heat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Advanced electric heating (WH)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Advanced electric heating base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Conventional electric heating (WH)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Conventional electric heating base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. BioOil&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. BioOil (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioOil&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioOil base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioOil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. BioGas&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. BioGas (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioGas&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. BioGas base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioGas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Hydrogen&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Hydrogen (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Hydrogen&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Hydrogen base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Solar&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Solar (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solar&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Solar base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Electric space cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Electric space cooling (WH)&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electric space cooling&#39;</span><span class="p">]</span> <span class="o">-</span>
             <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electric space cooling base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Electric space cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;CAPEX WH. Electricity&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dfDwellings</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;EP. Electricity (WH)&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electricity&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Electricity base&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">dfCSV</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Electricity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">val</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 17/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfCSV</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 18 -&gt; Calculate the General Schedule for each archetype</span>
<div class="viewcode-block" id="s18CalculateGeneralSchedule">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s18CalculateGeneralSchedule">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s18CalculateGeneralSchedule</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                <span class="n">dfSched</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                <span class="n">dfTemperatures</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                <span class="n">dfBaseTemperatures</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                <span class="n">dfSolarOffice</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                <span class="n">dfSolarNOffice</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                <span class="n">nutsId</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 18: Calculate the General Schedule for each archetype.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfSched (DataFrame): The DataFrame corresponding to Schedule.</span>
<span class="sd">        dfTemperatures (DataFrame): The DataFrame corresponding</span>
<span class="sd">            to Temperatures.</span>
<span class="sd">        dfBaseTemperatures (DataFrame): The DataFrame corresponding</span>
<span class="sd">            to Base Temperatures.</span>
<span class="sd">        dfSolarOffice (DataFrame): The DataFrame corresponding to Solar Office data.</span>
<span class="sd">        dfSolarNOffice (DataFrame): The DataFrame corresponding to Solar Non-Office data.</span>
<span class="sd">        nutsId (str): Identifier of NUTS2 region for which the</span>
<span class="sd">            analysis will be carried out.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        dict</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Divide the Schedule dataframe by column value</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 18/&gt;  Dividing the Schedule dataframe by archetypes...&#39;</span><span class="p">)</span>
    <span class="n">dfSchedGroups</span> <span class="o">=</span> <span class="n">dfSched</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Use&#39;</span><span class="p">)</span>

    <span class="c1"># Archetype: Apartment block</span>
    <span class="n">dfGenSchedApartmentBlock</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Apartment block&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedApartmentBlock</span> <span class="o">=</span> <span class="n">dfGenSchedApartmentBlock</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                          <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                          <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedApartmentBlock</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="c1"># Archetype: Single family- Terraced houses</span>
    <span class="n">dfGenSchedSingleFamily</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span>
        <span class="s1">&#39;Single family- Terraced houses&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedSingleFamily</span> <span class="o">=</span> <span class="n">dfGenSchedSingleFamily</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                        <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                        <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSingleFamily</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
    <span class="n">dfGenSchedSingleFamily</span> <span class="o">=</span> <span class="n">dfGenSchedSingleFamily</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Use&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Archetype: Hotels and Restaurants</span>
    <span class="n">dfGenSchedHotels</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Hotels and Restaurants&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedHotels</span> <span class="o">=</span> <span class="n">dfGenSchedHotels</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                  <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                  <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHotels</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="c1"># Archetype: Health</span>
    <span class="n">dfGenSchedHealth</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Health&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedHealth</span> <span class="o">=</span> <span class="n">dfGenSchedHealth</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                  <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                  <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedHealth</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="c1"># Archetype: Education</span>
    <span class="n">dfGenSchedEducation</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Education&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedEducation</span> <span class="o">=</span> <span class="n">dfGenSchedEducation</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                     <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                     <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedEducation</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="c1"># Archetype: Offices</span>
    <span class="n">dfGenSchedOffices</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Offices&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedOffices</span> <span class="o">=</span> <span class="n">dfGenSchedOffices</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                   <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                   <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOffices</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="c1"># Archetype: Trade</span>
    <span class="n">dfGenSchedTrade</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Trade&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedTrade</span> <span class="o">=</span> <span class="n">dfGenSchedTrade</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                 <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                 <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedTrade</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="c1"># Archetype: Other non-residential buildings</span>
    <span class="n">dfGenSchedOther</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span>
        <span class="s1">&#39;Other non-residential buildings&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedOther</span> <span class="o">=</span> <span class="n">dfGenSchedOther</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                 <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                 <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedOther</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="c1"># Archetype: Sport</span>
    <span class="n">dfGenSchedSport</span> <span class="o">=</span> <span class="n">dfSchedGroups</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;Sport&#39;</span><span class="p">)</span>
    <span class="n">dfGenSchedSport</span> <span class="o">=</span> <span class="n">dfGenSchedSport</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Heating&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> \
        <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;Cooling&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>
                                                                 <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfBaseTemperatures</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span>
                                                                 <span class="s1">&#39;Base Temperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfTemperatures</span><span class="p">[</span><span class="s1">&#39;HourlyTemperature&#39;</span><span class="p">]</span>
    <span class="n">dfGenSchedSport</span><span class="p">[</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfSolarNOffice</span><span class="p">[</span><span class="n">nutsId</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 18/&gt;  Building the final schedule...&#39;</span><span class="p">)</span>
    <span class="n">dictSchedule</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfCSV</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">schedule</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Apartment Block&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedApartmentBlock</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Single family- Terraced houses&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedSingleFamily</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Hotels and Restaurants&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedHotels</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Health&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedHealth</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Education&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedEducation</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Offices&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedOffices</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Trade&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedTrade</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Other non-residential buildings&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedOther</span>
        <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Sport&#39;</span><span class="p">:</span>
            <span class="n">schedule</span> <span class="o">=</span> <span class="n">dfGenSchedSport</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;use&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">],</span>
            <span class="s1">&#39;schedule&#39;</span><span class="p">:</span> <span class="n">schedule</span>
        <span class="p">}</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 18/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dictSchedule</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 19 -&gt; Calculate the Scenario</span>
<div class="viewcode-block" id="s19CalculateScenario">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s19CalculateScenario">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s19CalculateScenario</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                         <span class="n">dictSchedule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 19: Calculate the Scenario.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dictSchedule (dict): The dictionary corresponding to the Schedule. Example::</span>

<span class="sd">            {</span>
<span class="sd">                &quot;use&quot;: &quot;Apartment Block&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Single family- Terraced houses&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Offices&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Education&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Health&quot;, &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Trade&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Hotels and Restaurants&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Other non-residential buildings&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Sport&quot;, &quot;schedule&quot;: DataFrame</span>
<span class="sd">            }</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        dict</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 19/&gt;  Calculating the Scenario...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dictValue</span> <span class="ow">in</span> <span class="n">dictSchedule</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Concatenate the necessary columns and extract the CSV row to do the calculations</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">],</span>
                                                   <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D-Heating&#39;</span><span class="p">,</span> <span class="s1">&#39;D-Cooling&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;IG-Lighting&#39;</span><span class="p">,</span> <span class="s1">&#39;IG-Equipment&#39;</span><span class="p">,</span> <span class="s1">&#39;IG-Occupancy&#39;</span><span class="p">,</span> <span class="s1">&#39;IG-Solar&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;ARL-Heating Ventilation&#39;</span><span class="p">,</span> <span class="s1">&#39;ARL-Cooling Ventilation&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">,</span> <span class="s1">&#39;DG-Space Cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;DG-Water heating&#39;</span><span class="p">,</span> <span class="s1">&#39;DG-Lighting&#39;</span><span class="p">,</span> <span class="s1">&#39;DG-Appliances&#39;</span><span class="p">,</span> <span class="s1">&#39;DG-Cooking&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (Solids)-Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Space heating (LPG)-Liquids|Gas&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Space heating (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (Natural gas)-Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Space heating (Biomass)-Solids|Biomass&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (Geothermal)-Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Space heating (Distributed heat)-Heat&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (Advanced electric heating)-Electricity&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (Conventional electric heating)-Electricity&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Space heating (BioGas)-Gases|Biomass&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space heating (Hydrogen)-Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Space cooling (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Space cooling (Electric space cooling)-Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Water heating (Solids)-Solids|Coal&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Water heating (LPG)-Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Water heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Water heating (Natural gas)-Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Water heating (Biomass)-Solids|Biomass&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Water heating (Geothermal)-Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Water heating (Distributed heat)-Heat&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Water heating (Advanced electric heating)-Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Water heating (Electricity)-Electricity&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Water heating (Solar)-Heat|Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Water heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Water heating (BioGas)-Gases|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Water heating (Hydrogen)-Hydrogen&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Cooking (Solids)-Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Cooking (LPG)-Liquids|Gas&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Cooking (Natural gas)-Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Cooking (Biomass)-Solids|Biomass&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Cooking (Electricity)-Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;FC-Lighting (Electricity)-Electricity&#39;</span><span class="p">,</span>
                                                                         <span class="s1">&#39;FC-Appliances (Electricity)-Electricity&#39;</span><span class="p">])],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">csv</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span>
        <span class="n">dwellingsValue</span> <span class="o">=</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Occ. Dwellings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Sector&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Residential&#39;</span> <span class="k">else</span> <span class="mi">1</span>

        <span class="c1"># Demand [KWh] -&gt; &#39;D-&#39; prefix</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;D-Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;D-Factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;HDH&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e+03</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;D-Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;D-Factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;CDH&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e+03</span>

        <span class="c1"># Internal gains [KWh] -&gt; &#39;IG-&#39; prefix</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Lighting&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;IG-Li-Factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Lighting&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e+03</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Equipment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;IG-Eq-Factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Equipment&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e+03</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Occupancy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;IG-Oc-Factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Occupancy&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e+03</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Solar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Window Area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> \
            <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Solar&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1.0e+03</span>

        <span class="c1"># Air Renovation Losses -&gt; &#39;ARL-&#39; prefix</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;ARL-Heating Ventilation&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;ARL-Factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Base Heating Temp&#39;</span><span class="p">]</span> <span class="o">-</span>
                                         <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+03</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;ARL-Cooling Ventilation&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;ARL-Factor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Hourly Temp&#39;</span><span class="p">]</span> <span class="o">-</span>
                                         <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Base Cooling Temp&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1.0e+03</span>

        <span class="c1"># Demand considering Gains -&gt; &#39;DG-&#39; prefix</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;D-Heating&#39;</span><span class="p">]</span> <span class="o">+</span>
                                                               <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;ARL-Heating Ventilation&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Lighting&#39;</span><span class="p">]</span> <span class="o">-</span>
                                                               <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Equipment&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Occupancy&#39;</span><span class="p">]</span> <span class="o">-</span>
                                                               <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Solar&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Heating&#39;</span><span class="p">])</span> <span class="o">*</span>
                                                             <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Space heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">dwellingsValue</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Cooling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((((</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;D-Cooling&#39;</span><span class="p">]</span> <span class="o">+</span>
                                                                <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;ARL-Cooling Ventilation&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Lighting&#39;</span><span class="p">]</span> <span class="o">+</span>
                                                                <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Equipment&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Occupancy&#39;</span><span class="p">]</span> <span class="o">+</span>
                                                                <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Solar&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Cooling&#39;</span><span class="p">])</span> <span class="o">*</span>
                                                              <span class="n">constants</span><span class="o">.</span><span class="n">COOLING_REDUCTION_FACTOR</span><span class="p">)</span> <span class="o">*</span>
                                                             <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">dwellingsValue</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Cooling&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DHW&#39;</span><span class="p">]</span> <span class="o">*</span>
                                                             <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;DHW demand [KW/m2·year]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span>
                                                             <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DHW&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dwellingsValue</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Lighting&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Lighting&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dwellingsValue</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Lighting&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Appliances&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;IG-Equipment&#39;</span><span class="p">]</span> <span class="o">*</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dwellingsValue</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Appliances&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Cooking&#39;</span><span class="p">]</span> <span class="o">*</span>
                                                       <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Net heated floor area&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Cooking [KW/m2·year]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">*</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dwellingsValue</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

        <span class="c1"># Final consumption -&gt; &#39;FC-&#39; prefix</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Solids&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. LPG&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Diesel oil&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Geothermal)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Distributed heat)-Heat&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Distributed heat)-Heat&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Distributed heat)-Heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Conventional electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Conventional electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Conventional electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Conventional electric heating)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SH. Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SH. Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SC. Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SC. Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SC. Gas heat pumps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Electric space cooling)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Cooling&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;SC. Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SC. Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. SC. Electric space cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Electric space cooling)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Electric space cooling)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Diesel oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Geothermal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Geothermal)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Distributed heat)-Heat&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Distributed heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Distributed heat)-Heat&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Distributed heat)-Heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span>\
            <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Advanced electric heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solar)-Heat|Solar&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solar)-Heat|Solar&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solar)-Heat|Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. BioOil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. BioGas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;WH. Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. WH. Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;C. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Solids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Solids)-Solids|Coal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;C. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. LPG&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (LPG)-Liquids|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;C. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Natural gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;C. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;C. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. C. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Lighting (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Lighting&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;L. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. L. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. L. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Lighting (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Lighting (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Appliances (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="p">(</span><span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Appliances&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;A. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. A. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>\
            <span class="k">if</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;Eff. A. Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Appliances (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Appliances (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 19/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dictSchedule</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 20 -&gt; Calculate the Anual Results</span>
<div class="viewcode-block" id="s20CalculateAnualResults">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s20CalculateAnualResults">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s20CalculateAnualResults</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                             <span class="n">dictSchedule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 20: Calculate the Anual Results.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dictSchedule (dict): The dictionary corresponding to the Schedule. Example::</span>

<span class="sd">            {</span>
<span class="sd">                &quot;use&quot;: &quot;Apartment Block&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Single family- Terraced houses&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Offices&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Education&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Health&quot;, &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Trade&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Hotels and Restaurants&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Other non-residential buildings&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Sport&quot;, &quot;schedule&quot;: DataFrame</span>
<span class="sd">            }</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create the Anual Results dataframe</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 20/&gt;  Building the Anual Results dataframe...&#39;</span><span class="p">)</span>
    <span class="n">dfAnualResults</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Use&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Period&#39;</span><span class="p">,</span> <span class="s1">&#39;Sector&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Ref%&#39;</span><span class="p">,</span> <span class="s1">&#39;Ref Level&#39;</span><span class="p">,</span> <span class="s1">&#39;Footprint Area&#39;</span><span class="p">,</span> <span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">,</span> <span class="s1">&#39;Window Area&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;RFC Cost Low Wall&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Wall&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Wall&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;RFC Cost Low Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Roof&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;RFC Cost Low Window&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Window&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Window&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SH. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Natural gas&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SH. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Advanced electric heating&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SH. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Solar&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SH. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Electricity&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SC. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Natural gas&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SC. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Advanced electric heating&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SC. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Solar&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;SC. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Electricity&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;WH. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Natural gas&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;WH. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Advanced electric heating&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;WH. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Solar&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;WH. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Electricity&#39;</span><span class="p">]]</span>
    <span class="n">dfAnualResults</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfAnualResults</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Heating demand [KWh]&#39;</span><span class="p">,</span>
                                                                      <span class="s1">&#39;Cooling demand [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;DHW demand [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking demand [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting demand [KWh]&#39;</span><span class="p">,</span>
                                                                      <span class="s1">&#39;Equipment demand [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;Heating consumption [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooling consumption [KWh]&#39;</span><span class="p">,</span>
                                                                      <span class="s1">&#39;DHW consumption [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooking consumption [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;Lighting consumption [KWh]&#39;</span><span class="p">,</span>
                                                                      <span class="s1">&#39;Equipment consumption [KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX Passive measures [M€]&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPEX Active measures [M€]&#39;</span><span class="p">])],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Heating demand [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                                                                        <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Cooling demand [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                                                                        <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Space Cooling&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DHW demand [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                                                                    <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Water heating&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Cooking demand [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                                                                        <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Cooking&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Lighting demand [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                                                                         <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Lighting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Equipment demand [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                                                                          <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;DG-Appliances&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Heating consumption [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Geothermal)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Distributed heat)-Heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Conventional electric heating)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                         <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Cooling consumption [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                         <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Electric space cooling)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;DHW consumption [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Geothermal)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Distributed heat)-Heat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solar)-Heat|Solar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                         <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Cooking consumption [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Solids)-Solids|Coal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (LPG)-Liquids|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                         <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Lighting consumption [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                         <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Lighting (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Equipment consumption [KWh]&#39;</span><span class="p">]</span> <span class="o">=</span>\
            <span class="n">dictSchedule</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Building ID&#39;</span><span class="p">]</span>
                         <span class="p">][</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Appliances (Electricity)-Electricity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;CAPEX Passive measures [M€]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Ref%&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Footprint Area&#39;</span><span class="p">]</span> <span class="o">*</span>
                                                                                 <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RFC Cost &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Ref Level&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; Roof&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">]</span> <span class="o">*</span>
                                                                                 <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RFC Cost &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Ref Level&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; Wall&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Window Area&#39;</span><span class="p">]</span> <span class="o">*</span>
                                                                                 <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RFC Cost &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Ref Level&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; Window&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000000</span>
        <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;CAPEX Active measures [M€]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Solids&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost LPG&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Diesel oil&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Natural gas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Biomass&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Geothermal&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Distributed heat&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost BioOil&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost BioGas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Hydrogen&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Solar&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Electric space cooling&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SH. Cost Electricity&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Solids&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost LPG&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Diesel oil&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Natural gas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Biomass&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Geothermal&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Distributed heat&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost BioOil&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost BioGas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Hydrogen&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Solar&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Electric space cooling&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SC. Cost Electricity&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Solids&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost LPG&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Diesel oil&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Gas heat pumps&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Natural gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Biomass&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Geothermal&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Distributed heat&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Advanced electric heating&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Conventional electric heating&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost BioOil&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost BioGas&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Hydrogen&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Solar&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Electric space cooling&#39;</span><span class="p">]</span> <span class="o">+</span>\
            <span class="n">row</span><span class="p">[</span><span class="s1">&#39;WH. Cost Electricity&#39;</span><span class="p">]</span>

    <span class="c1"># Remove extra columns</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 20/&gt;  Cleaning the Anual Results dataframe&#39;</span><span class="p">)</span>
    <span class="n">dfAnualResults</span> <span class="o">=</span> <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ref%&#39;</span><span class="p">,</span> <span class="s1">&#39;Ref Level&#39;</span><span class="p">,</span> <span class="s1">&#39;Footprint Area&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;Opaque fachade area&#39;</span><span class="p">,</span> <span class="s1">&#39;Window Area&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Low Wall&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Wall&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Wall&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Low Roof&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;RFC Cost Medium Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Roof&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Low Window&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost Medium Window&#39;</span><span class="p">,</span> <span class="s1">&#39;RFC Cost High Window&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;SH. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Biomass&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;SH. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Conventional electric heating&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;SH. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;SH. Cost Electric space cooling&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;SH. Cost Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Diesel oil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Natural gas&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;SC. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Distributed heat&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Advanced electric heating&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;SC. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost BioGas&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Solar&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;SC. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;SC. Cost Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Solids&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost LPG&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Diesel oil&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;WH. Cost Gas heat pumps&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Natural gas&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Geothermal&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Distributed heat&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;WH. Cost Advanced electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Conventional electric heating&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioOil&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost BioGas&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;WH. Cost Hydrogen&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Electric space cooling&#39;</span><span class="p">,</span> <span class="s1">&#39;WH. Cost Electricity&#39;</span><span class="p">])</span>

    <span class="c1"># Save to Excel (if allowed)</span>
    <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">SAVE_RESULT_ALLOWED</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;temporary/result.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
            <span class="n">dfAnualResults</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span>
                <span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Anual Results&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 20/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfAnualResults</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 21 -&gt; Calculate the Consolidate</span>
<div class="viewcode-block" id="s21CalculateConsolidate">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s21CalculateConsolidate">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s21CalculateConsolidate</span><span class="p">(</span><span class="n">dictSchedule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                            <span class="n">archetype</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 21: Calculate the Consolidate.</span>

<span class="sd">    Args:</span>
<span class="sd">        dictSchedule (dict): The dictionary corresponding to the Schedule. Example::</span>

<span class="sd">            {</span>
<span class="sd">                &quot;use&quot;: &quot;Apartment Block&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Single family- Terraced houses&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Offices&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Education&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Health&quot;, &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Trade&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Hotels and Restaurants&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Other non-residential buildings&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Sport&quot;, &quot;schedule&quot;: DataFrame</span>
<span class="sd">            }</span>
<span class="sd">        </span>
<span class="sd">        archetype (str): The name of the archetype (building use).</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create the Consolidated dataframe</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 21/&gt;  Building the Consolidated (&#39;</span> <span class="o">+</span>
          <span class="n">archetype</span> <span class="o">+</span> <span class="s1">&#39;) dataframe...&#39;</span><span class="p">)</span>
    <span class="n">dfConsolidated</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Solids|Coal (Space Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Gas (Space Heating)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Liquids|Oil (Space Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gases|Gas (Space Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Solids|Biomass (Space Heating)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Electricity (Space Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat (Space Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Biomass (Space Heating)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Gases|Biomass (Space Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Hydrogen (Space Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat|Solar (Space Heating)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Coal (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Gas (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Oil (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gases|Gas (Space Cooling)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Biomass (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Biomass (Space Cooling)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Gases|Biomass (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Hydrogen (Space Cooling)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat|Solar (Space Cooling)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Coal (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Gas (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Oil (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gases|Gas (Water Heating)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Biomass (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Biomass (Water Heating)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Gases|Biomass (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Hydrogen (Water Heating)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat|Solar (Water Heating)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Coal (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Gas (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Oil (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gases|Gas (Lighting)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Biomass (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Biomass (Lighting)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Gases|Biomass (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Hydrogen (Lighting)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat|Solar (Lighting)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Coal (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Gas (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Oil (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gases|Gas (Appliances)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Biomass (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Biomass (Appliances)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Gases|Biomass (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Hydrogen (Appliances)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat|Solar (Appliances)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Coal (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Gas (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Oil (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Gases|Gas (Cooking)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Solids|Biomass (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Biomass (Cooking)&#39;</span><span class="p">,</span>
                                                <span class="s1">&#39;Gases|Biomass (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Hydrogen (Cooking)&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat|Solar (Cooking)&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">8760</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dictValue</span> <span class="ow">in</span> <span class="n">dictSchedule</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">archetype</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;Datetime&#39;</span> <span class="ow">in</span> <span class="n">dfConsolidated</span><span class="p">:</span>
                <span class="n">dfConsolidated</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Datetime&#39;</span><span class="p">,</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Datetime&#39;</span><span class="p">])</span>
                <span class="n">dfConsolidated</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Building Type&#39;</span><span class="p">,</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">])</span>
                <span class="n">dfConsolidated</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># Space heating</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Solids|Coal (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Liquids|Gas (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Liquids|Oil (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Gases|Gas (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Solids|Biomass (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Electricity (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Conventional electric heating)-Electricity&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Heat (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Distributed heat)-Heat&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Liquids|Biomass (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Gases|Biomass (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Hydrogen (Space Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span>

            <span class="c1"># Space cooling</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Gases|Gas (Space Cooling)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Electricity (Space Cooling)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Electric space cooling)-Electricity&#39;</span><span class="p">]</span>

            <span class="c1"># Water heating</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Solids|Coal (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Liquids|Gas (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Liquids|Oil (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Gases|Gas (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Solids|Biomass (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Electricity (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Electricity)-Electricity&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Heat (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Distributed heat)-Heat&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Heat|Solar (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solar)-Heat|Solar&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Liquids|Biomass (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Gases|Biomass (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Hydrogen (Water Heating)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span>

            <span class="c1"># Lighting and Appliances</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Electricity (Lighting)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Lighting (Electricity)-Electricity&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Electricity (Appliances)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Appliances (Electricity)-Electricity&#39;</span><span class="p">]</span>

            <span class="c1"># Cooking</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Solids|Coal (Cooking)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Solids)-Solids|Coal&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Liquids|Gas (Cooking)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (LPG)-Liquids|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Gases|Gas (Cooking)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Solids|Biomass (Cooking)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfConsolidated</span><span class="p">[</span><span class="s1">&#39;Electricity (Cooking)&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Electricity)-Electricity&#39;</span><span class="p">]</span>

    <span class="c1"># Save to Excel (if allowed)</span>
    <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">SAVE_RESULT_ALLOWED</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;temporary/result.xlsx&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
            <span class="n">dfConsolidated</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span>
                                    <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Consolidated (&#39;</span> <span class="o">+</span> <span class="n">archetype</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.)&#39;</span><span class="p">,</span>
                                    <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 21/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfConsolidated</span></div>



<span class="c1"># Function: Build. Energy Sim. -&gt; Model -&gt; Step 22 -&gt; Calculate the Hourly Results</span>
<div class="viewcode-block" id="s22CalculateHourlyResults">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.s22CalculateHourlyResults">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">s22CalculateHourlyResults</span><span class="p">(</span><span class="n">dfCSV</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                              <span class="n">dfSolar</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                              <span class="n">dictSchedule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                              <span class="n">archetype</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Step 22: Calculate the Hourly Results.</span>

<span class="sd">    Args:</span>
<span class="sd">        dfCSV (DataFrame): The built input data DataFrame.</span>
<span class="sd">        dfSolar (DataFrame): The solar data DataFrame.</span>
<span class="sd">        dictSchedule (dict): The dictionary corresponding to the Schedule. Example::</span>

<span class="sd">            {</span>
<span class="sd">                &quot;use&quot;: &quot;Apartment Block&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Single family- Terraced houses&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Offices&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Education&quot; &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Health&quot;, &quot;schedule&quot;: DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Trade&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Hotels and Restaurants&quot;, &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Other non-residential buildings&quot; &quot;schedule&quot; DataFrame,</span>
<span class="sd">                &quot;use&quot;: &quot;Sport&quot;, &quot;schedule&quot;: DataFrame</span>
<span class="sd">            }</span>
<span class="sd">        </span>
<span class="sd">        archetype (str): The name of the archetype (building use).</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create the Hourly Results dataframe</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 22/&gt;  Building the Hourly Results (&#39;</span> <span class="o">+</span>
          <span class="n">archetype</span> <span class="o">+</span> <span class="s1">&#39;) dataframe...&#39;</span><span class="p">)</span>
    <span class="n">dfHourlyResults</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Solids|Coal&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Oil&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;Gases|Gas&#39;</span><span class="p">,</span> <span class="s1">&#39;Solids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Electricity&#39;</span><span class="p">,</span> <span class="s1">&#39;Heat&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquids|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Gases|Biomass&#39;</span><span class="p">,</span> <span class="s1">&#39;Hydrogen&#39;</span><span class="p">,</span>
                                                 <span class="s1">&#39;Heat|Solar&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable cost [€/KWh]&#39;</span><span class="p">,</span> <span class="s1">&#39;Emissions [kgCO2/KWh]&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">8760</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dictValue</span> <span class="ow">in</span> <span class="n">dictSchedule</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">archetype</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;Datetime&#39;</span> <span class="ow">in</span> <span class="n">dfHourlyResults</span><span class="p">:</span>
                <span class="n">dfHourlyResults</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="s1">&#39;Datetime&#39;</span><span class="p">,</span>
                                       <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;Datetime&#39;</span><span class="p">])</span>
                <span class="n">dfHourlyResults</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                       <span class="s1">&#39;Building Type&#39;</span><span class="p">,</span>
                                       <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;use&#39;</span><span class="p">])</span>
                <span class="n">dfHourlyResults</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># Solids|Coal</span>
            <span class="n">solidsCoal</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solids)-Solids|Coal&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Solids)-Solids|Coal&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Solids|Coal&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">solidsCoal</span>

            <span class="c1"># Liquids|Gas</span>
            <span class="n">liquidsGas</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (LPG)-Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (LPG)-Liquids|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Liquids|Gas&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">liquidsGas</span>

            <span class="c1"># Liquids|Oil</span>
            <span class="n">liquidsOil</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Diesel oil)-Liquids|Oil&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Liquids|Oil&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">liquidsOil</span>

            <span class="c1"># Gases|Gas</span>
            <span class="n">gasesGas</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Gas heat pumps)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Natural gas)-Gases|Gas&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Gases|Gas&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gasesGas</span>

            <span class="c1"># Solids|Biomass</span>
            <span class="n">solidsBiomass</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Biomass)-Solids|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Solids|Biomass&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">solidsBiomass</span>

            <span class="c1"># Electricity: substract the value of the solar energy</span>
            <span class="n">electricity</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Conventional electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space cooling (Electric space cooling)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Geothermal)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Advanced electric heating)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Lighting (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Appliances (Electricity)-Electricity&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Cooking (Electricity)-Electricity&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Electricity&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">electricity</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="p">((</span><span class="n">dfSolar</span><span class="p">[</span><span class="n">archetype</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e+03</span><span class="p">))</span>

            <span class="c1"># Heat</span>
            <span class="n">heat</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Distributed heat)-Heat&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Distributed heat)-Heat&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Heat&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">heat</span>

            <span class="c1"># Liquids|Biomass</span>
            <span class="n">liquidsBiomass</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioOil)-Liquids|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Liquids|Biomass&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">liquidsBiomass</span>

            <span class="c1"># Gases|Biomass</span>
            <span class="n">gasesBiomass</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (BioGas)-Gases|Biomass&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Gases|Biomass&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">gasesBiomass</span>

            <span class="c1"># Hydrogen</span>
            <span class="n">hydrogen</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Space heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span> <span class="o">+</span>\
                <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Hydrogen)-Hydrogen&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Hydrogen&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hydrogen</span>

            <span class="c1"># Heat|Solar</span>
            <span class="n">heatSolar</span> <span class="o">=</span> <span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">][</span><span class="s1">&#39;FC-Water heating (Solar)-Heat|Solar&#39;</span><span class="p">]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Heat|Solar&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">heatSolar</span>

            <span class="c1"># Obtain the coefficients from CSV data, and adjust the shape to the schedule shape</span>
            <span class="n">csv</span> <span class="o">=</span> <span class="n">dfCSV</span><span class="p">[</span><span class="n">dfCSV</span><span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">archetype</span><span class="p">]</span>
            <span class="n">csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">csv</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">dictValue</span><span class="p">[</span><span class="s1">&#39;schedule&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">csv</span><span class="p">))]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Variable cost [€/KWh]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Variable cost [€/KWh]&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">solidsCoal</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Solids|Coal&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">liquidsGas</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Liquids|Gas&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">liquidsOil</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Liquids|Oil&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">gasesGas</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Gases|Gas&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">solidsBiomass</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Solids|Biomass&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">electricity</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Electricity&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">heat</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Heat&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">liquidsBiomass</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Liquids|Biomass&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">gasesBiomass</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Gases|Biomass&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">hydrogen</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Hydrogen&#39;</span><span class="p">])</span> <span class="o">+</span> \
                <span class="p">(</span><span class="n">heatSolar</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Variable cost Heat|Solar&#39;</span><span class="p">])</span>

            <span class="c1"># Emissions [kgCO2/KWh]</span>
            <span class="n">dfHourlyResults</span><span class="p">[</span><span class="s1">&#39;Emissions [kgCO2/KWh]&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">solidsCoal</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Solids|Coal&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">liquidsGas</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Liquids|Gas&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">liquidsOil</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Liquids|Oil&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">gasesGas</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Gases|Gas&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">solidsBiomass</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Solids|Biomass&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">electricity</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Electricity&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">heat</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Heat&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">liquidsBiomass</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Liquids|Biomass&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">gasesBiomass</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Gases|Biomass&#39;</span><span class="p">])</span> <span class="o">+</span>\
                <span class="p">(</span><span class="n">hydrogen</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Hydrogen&#39;</span><span class="p">])</span> <span class="o">+</span> \
                <span class="p">(</span><span class="n">heatSolar</span> <span class="o">*</span> <span class="n">csv</span><span class="p">[</span><span class="s1">&#39;OPEX Emissions Heat|Solar&#39;</span><span class="p">])</span>

    <span class="c1"># Save to Excel (if allowed)</span>
    <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">SAVE_RESULT_ALLOWED</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;temporary/result.xlsx&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
            <span class="n">dfHourlyResults</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span>
                                     <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Hourly Results (&#39;</span> <span class="o">+</span> <span class="n">archetype</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.)&#39;</span><span class="p">,</span>
                                     <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Finish</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Model: Step 22/&gt;  [OK]&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfHourlyResults</span></div>



<span class="c1">#####################################################################</span>
<span class="c1">######################## Auxiliary functions ########################</span>
<span class="c1">#####################################################################</span>


<span class="c1"># Auxiliary function 01: Add Feb. 29 if missing (for temperatures data)</span>
<div class="viewcode-block" id="x01AddFeb29IfMissingForTemperaturesData">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x01AddFeb29IfMissingForTemperaturesData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x01AddFeb29IfMissingForTemperaturesData</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                            <span class="n">targetYear</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 01: If the destination year is a leap year</span>
<span class="sd">        and the original year was not, replace 28-Feb with 29-Feb.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): The source DataFrame.</span>
<span class="sd">        targetYear (int): The target year.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">isleap</span><span class="p">(</span><span class="n">targetYear</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="n">feb28Start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-28 00:00:00&quot;</span><span class="p">)</span>
    <span class="n">feb28End</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-28 23:00:00&quot;</span><span class="p">)</span>
    <span class="n">feb29Start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-29 00:00:00&quot;</span><span class="p">)</span>
    <span class="n">feb29End</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-29 23:00:00&quot;</span><span class="p">)</span>

    <span class="n">feb28Hours</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">feb28Start</span><span class="p">,</span>
                               <span class="n">feb28End</span><span class="p">,</span>
                               <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">feb28Hours</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="n">feb28</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">feb28Hours</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">feb28</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">feb29Start</span><span class="p">,</span>
                                <span class="n">feb29End</span><span class="p">,</span>
                                <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">feb28</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">out</span></div>



<span class="c1"># Auxiliary function 02: Add Feb. 29 if missing (for radiation data)</span>
<div class="viewcode-block" id="x02AddFeb29IfMissingForRadiationData">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x02AddFeb29IfMissingForRadiationData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x02AddFeb29IfMissingForRadiationData</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
                                         <span class="n">targetYear</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 02: If the destination year is a leap year</span>
<span class="sd">        and the original year was not, replace 28-Feb with 29-Feb.</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): The source DataFrame.</span>
<span class="sd">        targetYear (int): The target year.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">isleap</span><span class="p">(</span><span class="n">targetYear</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">))</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="n">feb28Hours</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-28 00:00:00&quot;</span><span class="p">,</span>
                               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-28 23:00:00&quot;</span><span class="p">,</span>
                               <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">feb28Hours</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">df</span>
    <span class="n">feb28</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">feb28Hours</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">feb28</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-29 00:00:00&quot;</span><span class="p">,</span>
                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">targetYear</span><span class="si">}</span><span class="s2">-02-29 23:00:00&quot;</span><span class="p">,</span>
                                <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">feb28</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span></div>



<span class="c1"># Auxiliary function 03: Drop Feb. 29 if present (for temperatures data)</span>
<div class="viewcode-block" id="x03DropFeb29IfPresentForTemperaturesData">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x03DropFeb29IfPresentForTemperaturesData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x03DropFeb29IfPresentForTemperaturesData</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 03: Delete the rows for February 29 (if they exist).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): The source DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span></div>



<span class="c1"># Auxiliary function 04: Drop Feb. 29 if present (for radiation data)</span>
<div class="viewcode-block" id="x04DropFeb29IfPresentForRadiationData">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x04DropFeb29IfPresentForRadiationData">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x04DropFeb29IfPresentForRadiationData</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 04: Delete the rows for February 29 (if they exist).</span>

<span class="sd">    Args:</span>
<span class="sd">        df (DataFrame): The source DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">))]</span></div>



<span class="c1"># Auxiliary function 05: Remap year</span>
<div class="viewcode-block" id="x05RemapYear">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x05RemapYear">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x05RemapYear</span><span class="p">(</span><span class="n">tsIndex</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">,</span>
                 <span class="n">targetYear</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 05: Change the year of a DatetimeIndex while keeping</span>
<span class="sd">        the month/day/hour/minute/second values.</span>

<span class="sd">    Args:</span>
<span class="sd">        tsIndex (DatetimeIndex): The source DatetimeIndex.</span>
<span class="sd">        targetYear (int): The target year.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        DatetimeIndex</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">tsIndex</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">targetYear</span><span class="p">,</span>
                                              <span class="n">month</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">month</span><span class="p">,</span>
                                              <span class="n">day</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">day</span><span class="p">,</span>
                                              <span class="n">hour</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span>
                                              <span class="n">minute</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">minute</span><span class="p">,</span>
                                              <span class="n">second</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">second</span><span class="p">))</span></div>



<span class="c1"># Auxiliary function 06: Establish value between limits</span>
<div class="viewcode-block" id="x06EstablishValue">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x06EstablishValue">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x06EstablishValue</span><span class="p">(</span><span class="nb">dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                      <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                      <span class="n">limitDown</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">limitUp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">defaultValue</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 06: Establish value between limits.</span>

<span class="sd">    Args:</span>
<span class="sd">        dict (dict): The source dictionary.</span>
<span class="sd">        name (str): The source property.</span>
<span class="sd">        limitDown (float): The lower limit of the value.</span>
<span class="sd">        limitUp (float): The upper limit of the value.</span>
<span class="sd">        defaultValue (float): The default value.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        float</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">limitDown</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="n">limitUp</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">defaultValue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">defaultValue</span></div>



<span class="c1"># Auxiliary function 07: Obtain the available area</span>
<div class="viewcode-block" id="x07GetAvailableArea">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x07GetAvailableArea">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x07GetAvailableArea</span><span class="p">(</span><span class="n">parameters</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                        <span class="n">cost</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">landUse</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 07: Obtain the available area.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameters (list): The list of parameters.</span>
<span class="sd">        cost (float): The value of the cost.</span>
<span class="sd">        landUse (float): The value of the land use.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">index</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">capex</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cost</span> <span class="o">*</span> <span class="mf">1.0e+06</span><span class="p">)</span>            <span class="c1"># in MW</span>
        <span class="n">areaAvailable</span> <span class="o">=</span> <span class="n">power</span> <span class="o">*</span> <span class="mf">1.0e+06</span> <span class="o">/</span> <span class="n">landUse</span>               <span class="c1"># in m2</span>
    <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">areaAvailable</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.0e+06</span> <span class="o">/</span> <span class="n">landUse</span>   <span class="c1"># in m2</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">capex</span> <span class="o">=</span> <span class="n">power</span> <span class="o">*</span> <span class="n">cost</span> <span class="o">*</span> <span class="mf">1.0e+06</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">areaAvailable</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                           <span class="c1"># in m2</span>
        <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">areaAvailable</span> <span class="o">*</span> <span class="n">landUse</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e+06</span>             <span class="c1"># in MW</span>
        <span class="n">capex</span> <span class="o">=</span> <span class="n">power</span> <span class="o">*</span> <span class="n">cost</span> <span class="o">*</span> <span class="mf">1.0e+06</span>

    <span class="k">return</span> <span class="n">areaAvailable</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">capex</span></div>



<span class="c1"># Auxiliary function 08: Obtain the regions</span>
<div class="viewcode-block" id="x08GetRegions">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x08GetRegions">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x08GetRegions</span><span class="p">(</span><span class="n">dictScada</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                  <span class="n">area</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                  <span class="n">minGhi</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 08: Obtain the regions.</span>

<span class="sd">    Args:</span>
<span class="sd">        dictScada (DataFrame): The scada dataframe.</span>
<span class="sd">        area (float): The value of the area.</span>
<span class="sd">        minGhi (float): The value of the min GHI.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">currentSum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nameNuts2</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dictScada</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">nameNuts2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nameNuts2</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Area_m2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">currentSum</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Area_m2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">area</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Threshold&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">minGhi</span><span class="p">:</span>
                <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Area_m2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">area</span> <span class="o">-</span> <span class="n">currentSum</span>
                <span class="n">currentSum</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Area_m2&#39;</span><span class="p">]</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="n">currentSum</span> <span class="o">+=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Area_m2&#39;</span><span class="p">]</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">nameNuts2</span></div>



<span class="c1"># Auxiliary function 09: Obtain the PV production</span>
<div class="viewcode-block" id="x09GetPVProduction">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x09GetPVProduction">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x09GetPVProduction</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                       <span class="n">landUse</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">tilt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">distribAzimuth</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">tracking</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">loss</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">porcent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">year</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 09: Obtain the PV production.</span>

<span class="sd">    Args:</span>
<span class="sd">        rows (list): The list of rows.</span>
<span class="sd">        landUse (float): The value of the land use.</span>
<span class="sd">        tilt (float): The value of the tilt.</span>
<span class="sd">        distribAzimuth (float): The value of the distribAzimuth.</span>
<span class="sd">        tracking (float): The value of the tracking.</span>
<span class="sd">        loss (float): The value of the loss.</span>
<span class="sd">        porcent (float): The value of the porcent.</span>
<span class="sd">        year (int): The year.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">production</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">region</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">region</span><span class="p">[</span><span class="s1">&#39;Median_Radiation_X&#39;</span><span class="p">],</span> <span class="n">region</span><span class="p">[</span><span class="s1">&#39;Median_Radiation_Y&#39;</span><span class="p">]</span>

        <span class="c1"># Convert coordinates from EPSG:3035 to EPSG:4326</span>
        <span class="k">if</span> <span class="n">constants</span><span class="o">.</span><span class="n">CONVERT_COORD</span> <span class="ow">or</span> <span class="n">lat</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span> 
            <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">x11GetCoordinates</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>

        <span class="n">pot_MW</span> <span class="o">=</span> <span class="p">(</span><span class="n">region</span><span class="p">[</span><span class="s1">&#39;Area_m2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">landUse</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0e+06</span>
        <span class="n">region</span><span class="p">[</span><span class="s1">&#39;power_installed(kW)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pot_MW</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">pot_MW</span> <span class="o">*</span> <span class="mf">1.0e+03</span> <span class="o">&gt;</span> <span class="mf">1.0e+08</span><span class="p">:</span>
            <span class="n">pot_MW</span> <span class="o">=</span> <span class="n">pot_MW</span> <span class="o">/</span> <span class="mf">1.0e+03</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="mf">1.0e+03</span>

        <span class="n">prod</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">porcent</span><span class="p">)):</span>
            <span class="n">df</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">iotools</span><span class="o">.</span><span class="n">get_pvgis_hourly</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span>
                                                              <span class="n">longitude</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span>
                                                              <span class="n">start</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
                                                              <span class="n">end</span><span class="o">=</span><span class="n">year</span><span class="p">,</span>
                                                              <span class="n">raddatabase</span><span class="o">=</span><span class="s1">&#39;PVGIS-SARAH2&#39;</span><span class="p">,</span>
                                                              <span class="n">surface_tilt</span><span class="o">=</span><span class="n">tilt</span><span class="p">,</span>
                                                              <span class="n">surface_azimuth</span><span class="o">=</span><span class="n">distribAzimuth</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                              <span class="n">pvcalculation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                              <span class="n">peakpower</span><span class="o">=</span><span class="n">pot_MW</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">porcent</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                              <span class="n">trackingtype</span><span class="o">=</span><span class="n">tracking</span><span class="p">,</span>
                                                              <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span>
                                                              <span class="n">components</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                              <span class="n">url</span><span class="o">=</span><span class="s1">&#39;https://re.jrc.ec.europa.eu/api/v5_2/&#39;</span><span class="p">)</span>
            <span class="n">prod</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">])</span>

        <span class="n">region</span><span class="p">[</span><span class="s1">&#39;production&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">prod</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">*</span> <span class="n">factor</span> <span class="o">/</span> <span class="mf">1.0e+06</span>  <span class="c1"># to MW</span>
        <span class="n">production</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">prod</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span> <span class="o">/</span> <span class="mf">1.0e+06</span><span class="p">))</span>  <span class="c1"># to MW</span>

    <span class="k">return</span> <span class="n">production</span></div>



<span class="c1"># Auxiliary function 10: Obtain the distribution</span>
<div class="viewcode-block" id="x10GetDistribution">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x10GetDistribution">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x10GetDistribution</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                       <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 10: Obtain the distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        rows (list): The list of rows.</span>
<span class="sd">        label (str): The label.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">])</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
    <span class="n">sumNuts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sumAreas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sumPots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">nuts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]][</span><span class="n">label</span><span class="p">]</span>
        <span class="n">df_nuts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">nuts</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">sumNuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_nuts</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
        <span class="n">areasNuts3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]][</span><span class="s1">&#39;Area_m2&#39;</span><span class="p">]</span>
        <span class="n">potNuts3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">]][</span><span class="s1">&#39;power_installed(kW)&#39;</span><span class="p">]</span>
        <span class="n">sumAreas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">areasNuts3</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
        <span class="n">sumPots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">potNuts3</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

    <span class="n">areas</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sumAreas</span><span class="p">]))</span>
    <span class="n">pots</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sumPots</span><span class="p">]))</span>

    <span class="n">nuts2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sumNuts</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">res</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">nuts2</span> <span class="o">=</span> <span class="n">nuts2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">nuts2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">nuts2</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y %H:%M&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nuts2</span><span class="p">,</span> <span class="n">pots</span><span class="p">,</span> <span class="n">areas</span></div>



<span class="c1"># Auxiliary function 11: Obtain the coordinates</span>
<div class="viewcode-block" id="x11GetCoordinates">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x11GetCoordinates">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x11GetCoordinates</span><span class="p">(</span><span class="n">sourceDF</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 11: Obtain the coordinates.</span>

<span class="sd">    Args:</span>
<span class="sd">        sourceDF (DataFrame): The source DataFrame.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:3035&quot;</span><span class="p">,</span> <span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
                                       <span class="n">always_xy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">sourceDF</span><span class="p">[</span><span class="s1">&#39;Median_Radiation_X&#39;</span><span class="p">],</span>
                               <span class="n">sourceDF</span><span class="p">[</span><span class="s1">&#39;Median_Radiation_Y&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>



<span class="c1"># Auxiliary function 12: Calculate the OPEX</span>
<div class="viewcode-block" id="x12CalculateOPEX">
<a class="viewcode-back" href="../../modules.html#building_stock_energy_model.model.x12CalculateOPEX">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">x12CalculateOPEX</span><span class="p">(</span><span class="n">pot</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                     <span class="n">opexPV</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Auxiliary function 12: Calculate the OPEX.</span>

<span class="sd">    Args:</span>
<span class="sd">        pot (dict): The pot dictionary.</span>
<span class="sd">        opexPV (float): The OPEX for PV.</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sumPV</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">pot</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">sumPV</span> <span class="o">+=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">sumPV</span> <span class="o">*</span> <span class="n">opexPV</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Tecnalia
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=82662543"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>